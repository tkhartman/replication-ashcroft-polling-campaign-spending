<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="data:text/css;charset=utf-8,%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20octicons%2Dlink%3B%0Asrc%3A%20url%28data%3Afont%2Fwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM%2B8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB%2FaFGpk3jaTY6xa8JAGMW%2FO62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v%2Bk%2F0an2i%2BitHDw3v2%2B9%2BDBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3%2FI7AtxEJLtzzuZfI%2BVVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy%2FLt7Kc%2B0vWY%2FgAgIIEqAN9we0pwKXreiMasxvabDQMM4riO%2BqxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw%2Bymhce7vwM9jSqO8JyVd5RH9gyTt2%2BJ%2FyUmYlIR0s04n6%2B7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv%2FocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi%2BW2%2BMjCzMIDApSwvXzC97Z4Ig8N%2FBxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh%2F8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT%2BAEjAwuDFpBmA9KMDEwMCh9i%2Fv8H8sH0%2F4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9%2FlqYwOGZxeUelN2U2R6%2BcArgtCJpauW7UQBqnFkUsjAY%2FkOU1cP%2BDAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl%2BvvmM%2FbyA48e6tWrKArm4ZJlCbdsrxksL1AwWn%2FyBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO%2F%2FsdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd%2F89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF%2B9JOS0nbaaYDCQfwCJ7Au3AHj%2BLO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm%2BEBXuAbHmIMSRMs%2B4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL%2BhD7C1xoaHeLJSEao0FEW14ckxC%2BTU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13%2F%2Blm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl%2B9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O%2FAdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB%2F%2F%2FAA8AAQAAAAAAAAAAAAAAAAABAAAAAA%3D%3D%29%20format%28%27woff%27%29%3B%0A%7D%0Abody%20%7B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0Atext%2Dsize%2Dadjust%3A%20100%25%3B%0Acolor%3A%20%23333%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20%22Segoe%20UI%22%2C%20Arial%2C%20freesans%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E6%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Aa%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0A%7D%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0Aoutline%3A%200%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202em%3B%0Amargin%3A%200%2E67em%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%7D%0Ahr%20%7B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Aheight%3A%200%3B%0A%7D%0Apre%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%2C%0Akbd%2C%0Apre%20%7B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ainput%20%7B%0Acolor%3A%20inherit%3B%0Afont%3A%20inherit%3B%0Amargin%3A%200%3B%0A%7D%0Ahtml%20input%5Bdisabled%5D%20%7B%0Acursor%3A%20default%3B%0A%7D%0Ainput%20%7B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Apadding%3A%200%3B%0A%7D%0Atable%20%7B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0Atd%2C%0Ath%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2A%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Ainput%20%7B%0Afont%3A%2013px%20%2F%201%2E4%20Helvetica%2C%20arial%2C%20nimbussansl%2C%20liberationsans%2C%20freesans%2C%20clean%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%234078c0%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200%3B%0Amargin%3A%2015px%200%3B%0Aoverflow%3A%20hidden%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0Ahr%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ahr%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%2015px%3B%0Amargin%2Dbottom%3A%2015px%3B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2030px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2021px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011px%3B%0A%7D%0Ablockquote%20%7B%0Amargin%3A%200%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aol%20ol%2C%0Aul%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Droman%3B%0A%7D%0Aul%20ul%20ol%2C%0Aul%20ol%20ol%2C%0Aol%20ul%20ol%2C%0Aol%20ol%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Dalpha%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0Afont%3A%2012px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0A%7D%0A%2Eselect%3A%3A%2Dms%2Dexpand%20%7B%0Aopacity%3A%200%3B%0A%7D%0A%2Eocticon%20%7B%0Afont%3A%20normal%20normal%20normal%2016px%2F1%20octicons%2Dlink%3B%0Adisplay%3A%20inline%2Dblock%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Drendering%3A%20auto%3B%0A%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3B%0A%2Dmoz%2Dosx%2Dfont%2Dsmoothing%3A%20grayscale%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%0A%7D%0A%2Eocticon%2Dlink%3Abefore%20%7B%0Acontent%3A%20%27%5Cf05c%27%3B%0A%7D%0A%2Emarkdown%2Dbody%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%20%21important%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%20%21important%3B%0A%7D%0Aa%3Anot%28%5Bhref%5D%29%20%7B%0Acolor%3A%20inherit%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Eanchor%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%2Dright%3A%202px%3B%0Amargin%2Dleft%3A%20%2D18px%3B%0A%7D%0A%2Eanchor%3Afocus%20%7B%0Aoutline%3A%20none%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%201em%3B%0Amargin%2Dbottom%3A%2016px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%201%2E4%3B%0A%7D%0Ah1%20%2Eocticon%2Dlink%2C%0Ah2%20%2Eocticon%2Dlink%2C%0Ah3%20%2Eocticon%2Dlink%2C%0Ah4%20%2Eocticon%2Dlink%2C%0Ah5%20%2Eocticon%2Dlink%2C%0Ah6%20%2Eocticon%2Dlink%20%7B%0Acolor%3A%20%23000%3B%0Avertical%2Dalign%3A%20middle%3B%0Avisibility%3A%20hidden%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%2C%0Ah2%3Ahover%20%2Eanchor%2C%0Ah3%3Ahover%20%2Eanchor%2C%0Ah4%3Ahover%20%2Eanchor%2C%0Ah5%3Ahover%20%2Eanchor%2C%0Ah6%3Ahover%20%2Eanchor%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah2%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah3%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah4%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah5%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah6%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%20%7B%0Avisibility%3A%20visible%3B%0A%7D%0Ah1%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%202%2E25em%3B%0Aline%2Dheight%3A%201%2E2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah1%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah2%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%201%2E75em%3B%0Aline%2Dheight%3A%201%2E225%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah2%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%201%2E43%3B%0A%7D%0Ah3%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E25em%3B%0A%7D%0Ah4%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah5%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%201em%3B%0Acolor%3A%20%23777%3B%0A%7D%0Ah6%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ap%2C%0Ablockquote%2C%0Aul%2C%0Aol%2C%0Adl%2C%0Atable%2C%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%204px%3B%0Apadding%3A%200%3B%0Amargin%3A%2016px%200%3B%0Abackground%2Dcolor%3A%20%23e7e7e7%3B%0Aborder%3A%200%20none%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%2Dleft%3A%202em%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%3Ep%20%7B%0Amargin%2Dtop%3A%2016px%3B%0A%7D%0Adl%20%7B%0Apadding%3A%200%3B%0A%7D%0Adl%20dt%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%2016px%3B%0Afont%2Dsize%3A%201em%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adl%20dd%20%7B%0Apadding%3A%200%2016px%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%2015px%3B%0Acolor%3A%20%23777%3B%0Aborder%2Dleft%3A%204px%20solid%20%23ddd%3B%0A%7D%0Ablockquote%3E%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Ablockquote%3E%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Atable%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Aoverflow%3A%20auto%3B%0Aword%2Dbreak%3A%20normal%3B%0Aword%2Dbreak%3A%20keep%2Dall%3B%0A%7D%0Atable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Atable%20th%2C%0Atable%20td%20%7B%0Apadding%3A%206px%2013px%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20tr%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ccc%3B%0A%7D%0Atable%20tr%3Anth%2Dchild%282n%29%20%7B%0Abackground%2Dcolor%3A%20%23f8f8f8%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%3B%0Apadding%2Dtop%3A%200%2E2em%3B%0Apadding%2Dbottom%3A%200%2E2em%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%2085%25%3B%0Abackground%2Dcolor%3A%20rgba%280%2C0%2C0%2C0%2E04%29%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%3Abefore%2C%0Acode%3Aafter%20%7B%0Aletter%2Dspacing%3A%20%2D0%2E2em%3B%0Acontent%3A%20%22%5C00a0%22%3B%0A%7D%0Apre%3Ecode%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Aword%2Dbreak%3A%20normal%3B%0Awhite%2Dspace%3A%20pre%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Ehighlight%20%7B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0A%2Ehighlight%20pre%2C%0Apre%20%7B%0Apadding%3A%2016px%3B%0Aoverflow%3A%20auto%3B%0Afont%2Dsize%3A%2085%25%3B%0Aline%2Dheight%3A%201%2E45%3B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Ehighlight%20pre%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aword%2Dbreak%3A%20normal%3B%0A%7D%0Apre%20%7B%0Aword%2Dwrap%3A%20normal%3B%0A%7D%0Apre%20code%20%7B%0Adisplay%3A%20inline%3B%0Amax%2Dwidth%3A%20initial%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20initial%3B%0Aline%2Dheight%3A%20inherit%3B%0Aword%2Dwrap%3A%20normal%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0Apre%20code%3Abefore%2C%0Apre%20code%3Aafter%20%7B%0Acontent%3A%20normal%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%2Dsize%3A%2011px%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Epl%2Dc%20%7B%0Acolor%3A%20%23969896%3B%0A%7D%0A%2Epl%2Dc1%2C%0A%2Epl%2Ds%20%2Epl%2Dv%20%7B%0Acolor%3A%20%230086b3%3B%0A%7D%0A%2Epl%2De%2C%0A%2Epl%2Den%20%7B%0Acolor%3A%20%23795da3%3B%0A%7D%0A%2Epl%2Ds%20%2Epl%2Ds1%2C%0A%2Epl%2Dsmi%20%7B%0Acolor%3A%20%23333%3B%0A%7D%0A%2Epl%2Dent%20%7B%0Acolor%3A%20%2363a35c%3B%0A%7D%0A%2Epl%2Dk%20%7B%0Acolor%3A%20%23a71d5d%3B%0A%7D%0A%2Epl%2Dpds%2C%0A%2Epl%2Ds%2C%0A%2Epl%2Ds%20%2Epl%2Dpse%20%2Epl%2Ds1%2C%0A%2Epl%2Dsr%2C%0A%2Epl%2Dsr%20%2Epl%2Dcce%2C%0A%2Epl%2Dsr%20%2Epl%2Dsra%2C%0A%2Epl%2Dsr%20%2Epl%2Dsre%20%7B%0Acolor%3A%20%23183691%3B%0A%7D%0A%2Epl%2Dv%20%7B%0Acolor%3A%20%23ed6a43%3B%0A%7D%0A%2Epl%2Did%20%7B%0Acolor%3A%20%23b52a1d%3B%0A%7D%0A%2Epl%2Dii%20%7B%0Abackground%2Dcolor%3A%20%23b52a1d%3B%0Acolor%3A%20%23f8f8f8%3B%0A%7D%0A%2Epl%2Dsr%20%2Epl%2Dcce%20%7B%0Acolor%3A%20%2363a35c%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dml%20%7B%0Acolor%3A%20%23693a17%3B%0A%7D%0A%2Epl%2Dmh%2C%0A%2Epl%2Dmh%20%2Epl%2Den%2C%0A%2Epl%2Dms%20%7B%0Acolor%3A%20%231d3e81%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmq%20%7B%0Acolor%3A%20%23008080%3B%0A%7D%0A%2Epl%2Dmi%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0A%2Epl%2Dmb%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmd%20%7B%0Abackground%2Dcolor%3A%20%23ffecec%3B%0Acolor%3A%20%23bd2c00%3B%0A%7D%0A%2Epl%2Dmi1%20%7B%0Abackground%2Dcolor%3A%20%23eaffea%3B%0Acolor%3A%20%2355a532%3B%0A%7D%0A%2Epl%2Dmdr%20%7B%0Acolor%3A%20%23795da3%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmo%20%7B%0Acolor%3A%20%231d3e81%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%3A%2011px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20%7B%0Alist%2Dstyle%2Dtype%3A%20none%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%2B%2Etask%2Dlist%2Ditem%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20input%20%7B%0Amargin%3A%200%200%2E35em%200%2E25em%20%2D1%2E6em%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0A%3Achecked%2B%2Eradio%2Dlabel%20%7B%0Az%2Dindex%3A%201%3B%0Aposition%3A%20relative%3B%0Aborder%2Dcolor%3A%20%234078c0%3B%0A%7D%0Acode%20%3E%20%2Ekw%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Edt%20%7B%20color%3A%20%23ed6a43%3B%20%7D%0Acode%20%3E%20%2Edv%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%3E%20%2Ebn%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%3E%20%2Efl%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%3E%20%2Ech%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%3E%20%2Est%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%3E%20%2Eco%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%3E%20%2Eot%20%7B%20color%3A%20%230086b3%3B%20%7D%0Acode%20%3E%20%2Eal%20%7B%20color%3A%20%23a61717%3B%20%7D%0Acode%20%3E%20%2Efu%20%7B%20color%3A%20%2363a35c%3B%20%7D%0Acode%20%3E%20%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%0Acode%20%3E%20%2Ewa%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Ecn%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Esc%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Evs%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%3E%20%2Ess%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%3E%20%2Eim%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Eva%20%7Bcolor%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Ecf%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Eop%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Ebu%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Eex%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%3E%20%2Epp%20%7B%20color%3A%20%23999999%3B%20%7D%0Acode%20%3E%20%2Eat%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Edo%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%3E%20%2Ean%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Ecv%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%3E%20%2Ein%20%7B%20color%3A%20%23008080%3B%20%7D%0A" rel="stylesheet">
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="modelling-of-constituency-campaign-spending-in-the-2015-uk-general-election">Modelling of Constituency Campaign Spending in the 2015 UK General Election</h1>
<p>Todd K. Hartman<br />
2017-05-10</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## rmarkdown::render(&quot;UK_Constituency_Spending_and_Polling_v3.R&quot;)</code></pre></div>
<p>Housekeeping</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Load packages via 'pacman'
pacman::<span class="kw">p_load</span>(dplyr, haven, plyr, readxl, survey, tidyr, zeligverse)

## Set display options
<span class="kw">options</span>(<span class="st">&quot;scipen&quot;</span> =<span class="st"> </span><span class="dv">100</span>, <span class="st">&quot;digits&quot;</span> =<span class="st"> </span><span class="dv">4</span>)

## Set the working directory
<span class="co"># setwd(&quot;C:/users/fs1tkh/Dropbox/_RESEARCH/Pattie_Johnston_2015_UK_Election/Ashcroft_Polling_Project/Data/&quot;) # Mac OSX</span>
<span class="co"># setwd(&quot;~/Dropbox/_RESEARCH/Pattie_Johnston_2015_UK_Election/Ashcroft_Polling_Project/Data/&quot;) # Mac OSX</span></code></pre></div>
<p>Load the 2015 campaign spending data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Download (or load if downloaded) from the Electoral Commission website
## http://www.electoralcommission.org.uk/find-information-by-subject/elections-and-referendums/past-elections-and-referendums/uk-general-elections/candidate-election-spending
url<span class="fl">.15</span> &lt;-<span class="st"> &quot;https://www.electoralcommission.org.uk/__data/assets/excel_doc/0004/199066/2015-UK-Parliament-spending-data.xlsx&quot;</span>
file<span class="fl">.15</span> &lt;-<span class="st"> </span><span class="kw">basename</span>(url<span class="fl">.15</span>)  <span class="co"># Extract the filename</span>
if (!<span class="kw">file.exists</span>(file<span class="fl">.15</span>))   <span class="co"># Only download if not in the working directory</span>
    <span class="kw">download.file</span>(<span class="dt">url =</span> url<span class="fl">.15</span>, <span class="dt">destfile =</span> file<span class="fl">.15</span>, <span class="dt">mode =</span> <span class="st">&quot;wb&quot;</span>)
spend<span class="fl">.15</span> &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file<span class="fl">.15</span>)  <span class="co"># Load the dataset</span>

## Subset the data
<span class="kw">names</span>(spend<span class="fl">.15</span>)</code></pre></div>
<pre><code>##  [1] &quot;ConstituencyId&quot;                     
##  [2] &quot;EntityId&quot;                           
##  [3] &quot;CandId&quot;                             
##  [4] &quot;Forename&quot;                           
##  [5] &quot;Surname&quot;                            
##  [6] &quot;Party Name&quot;                         
##  [7] &quot;Constituency Name&quot;                  
##  [8] &quot;Constituency Type&quot;                  
##  [9] &quot;Area&quot;                               
## [10] &quot;Nation&quot;                             
## [11] &quot;Electorate (Limit)&quot;                 
## [12] &quot;Long Limit&quot;                         
## [13] &quot;Short Limit&quot;                        
## [14] &quot;Long Total Spend&quot;                   
## [15] &quot;Short Total Spend&quot;                  
## [16] &quot;Spend % of Long Limit&quot;              
## [17] &quot;Spend as % of Short Limit&quot;          
## [18] &quot;Long 3a Unpaid&quot;                     
## [19] &quot;Long 3a Disputed&quot;                   
## [20] &quot;Long 3a Notional&quot;                   
## [21] &quot;Long 3a Payments&quot;                   
## [22] &quot;Long 3a Total&quot;                      
## [23] &quot;Long 3b Advertising&quot;                
## [24] &quot;Long 3b Unsolicited&quot;                
## [25] &quot;Long 3b Transport&quot;                  
## [26] &quot;Long 3b Public Meetings&quot;            
## [27] &quot;Long 3b Agent and Staff&quot;            
## [28] &quot;Long 3b Accommodation&quot;              
## [29] &quot;Long 3b Total&quot;                      
## [30] &quot;Long Personal Expenses&quot;             
## [31] &quot;Long Candidate Money&quot;               
## [32] &quot;Long Donations Accepted (Over £50)&quot; 
## [33] &quot;Long Donations Rejected&quot;            
## [34] &quot;Short 3a Unpaid&quot;                    
## [35] &quot;Short 3a Disputed&quot;                  
## [36] &quot;Short 3a Notional&quot;                  
## [37] &quot;Short 3a Payments&quot;                  
## [38] &quot;Short 3a Total&quot;                     
## [39] &quot;Short 3b Advertising&quot;               
## [40] &quot;Short 3b Unsolicited&quot;               
## [41] &quot;Short 3b Transport&quot;                 
## [42] &quot;Short 3b Public Meetings&quot;           
## [43] &quot;Short 3b Agent and Staff&quot;           
## [44] &quot;Short 3b Accommodation&quot;             
## [45] &quot;Short 3b Total&quot;                     
## [46] &quot;Short Personal Expenses&quot;            
## [47] &quot;Short Candidate Money&quot;              
## [48] &quot;Short Donations Accepted (Over £50)&quot;
## [49] &quot;Short Donations Rejected&quot;           
## [50] &quot;EntityJointID&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spend<span class="fl">.15</span>.sub &lt;-<span class="st"> </span><span class="kw">subset</span>(spend<span class="fl">.15</span>, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">`</span><span class="dt">ConstituencyId</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Party Name</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Spend as % of Short Limit</span><span class="st">`</span>))
spend<span class="fl">.15</span>.sub$ons &lt;-<span class="st"> </span>spend<span class="fl">.15</span>.sub$<span class="st">`</span><span class="dt">ConstituencyId</span><span class="st">`</span>
spend<span class="fl">.15</span>.sub$party &lt;-<span class="st"> </span>spend<span class="fl">.15</span>.sub$<span class="st">`</span><span class="dt">Party Name</span><span class="st">`</span>
spend<span class="fl">.15</span>.sub$shortpct15 &lt;-<span class="st"> </span>spend<span class="fl">.15</span>.sub$<span class="st">`</span><span class="dt">Spend as % of Short Limit</span><span class="st">`</span>
spend<span class="fl">.15</span>.sub$<span class="st">`</span><span class="dt">ConstituencyId</span><span class="st">`</span> &lt;-<span class="st"> </span>spend<span class="fl">.15</span>.sub$<span class="st">`</span><span class="dt">Party Name</span><span class="st">`</span> &lt;-<span class="st"> </span>spend<span class="fl">.15</span>.sub$<span class="st">`</span><span class="dt">Spend as % of Short Limit</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">write.csv</span>(spend<span class="fl">.15</span>.sub, <span class="st">&quot;UK_2015_LONG.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Load the 2010 campaign spending data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Download (or load if downloaded) from the Electoral Commission website
url<span class="fl">.10</span> &lt;-<span class="st"> &quot;http://www.electoralcommission.org.uk/__data/assets/excel_doc/0020/150806/2010-UK-Parliament-spending-data-Excel.xls&quot;</span>
file<span class="fl">.10</span> &lt;-<span class="st"> </span><span class="kw">basename</span>(url<span class="fl">.10</span>)  <span class="co"># Extract the filename</span>
if (!<span class="kw">file.exists</span>(file<span class="fl">.10</span>))   <span class="co"># Only download if not in the working directory</span>
    <span class="kw">download.file</span>(<span class="dt">url =</span> url<span class="fl">.10</span>, <span class="dt">destfile =</span> file<span class="fl">.10</span>, <span class="dt">mode =</span> <span class="st">&quot;wb&quot;</span>)
spend<span class="fl">.10</span> &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">read_excel</span>(file<span class="fl">.10</span>, <span class="dt">sheet =</span> <span class="dv">3</span>))  <span class="co"># Load the dataset</span></code></pre></div>
<pre><code>## DEFINEDNAME: 21 00 00 01 0b 00 00 00 03 00 00 00 00 00 00 0d 3b 00 00 00 00 c0 0f 00 00 33 00 
## DEFINEDNAME: 21 00 00 01 0b 00 00 00 03 00 00 00 00 00 00 0d 3b 00 00 00 00 c0 0f 00 00 33 00 
## DEFINEDNAME: 21 00 00 01 0b 00 00 00 03 00 00 00 00 00 00 0d 3b 00 00 00 00 c0 0f 00 00 33 00 
## DEFINEDNAME: 21 00 00 01 0b 00 00 00 03 00 00 00 00 00 00 0d 3b 00 00 00 00 c0 0f 00 00 33 00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Subset the data
<span class="kw">names</span>(spend<span class="fl">.10</span>)</code></pre></div>
<pre><code>##  [1] &quot;ConstituencyId&quot;                     
##  [2] &quot;EntityId&quot;                           
##  [3] &quot;CandId&quot;                             
##  [4] &quot;Forename&quot;                           
##  [5] &quot;Surname&quot;                            
##  [6] &quot;Party Name&quot;                         
##  [7] &quot;Constituency Name&quot;                  
##  [8] &quot;Constituency Type&quot;                  
##  [9] &quot;Area&quot;                               
## [10] &quot;Nation&quot;                             
## [11] &quot;Votes&quot;                              
## [12] &quot;Votes %&quot;                            
## [13] &quot;Position&quot;                           
## [14] &quot;Electorate (Limit)&quot;                 
## [15] &quot;Long Limit&quot;                         
## [16] &quot;Short Limit&quot;                        
## [17] &quot;Long Total Spend&quot;                   
## [18] &quot;Short Total Spend&quot;                  
## [19] &quot;Spend as % of Long Limit&quot;           
## [20] &quot;Spend as % of Short Limit&quot;          
## [21] &quot;Long 3a Unpaid&quot;                     
## [22] &quot;Long 3a Disputed&quot;                   
## [23] &quot;Long 3a Notional&quot;                   
## [24] &quot;Long 3a Payments&quot;                   
## [25] &quot;Long 3a Total&quot;                      
## [26] &quot;Long 3b Advertising&quot;                
## [27] &quot;Long 3b Unsolicited&quot;                
## [28] &quot;Long 3b Transport&quot;                  
## [29] &quot;Long 3b Public Meetings&quot;            
## [30] &quot;Long 3b Agent and Staff&quot;            
## [31] &quot;Long 3b Accommodation&quot;              
## [32] &quot;Long 3b Total&quot;                      
## [33] &quot;Long Personal Expenses&quot;             
## [34] &quot;Long Candidate Money&quot;               
## [35] &quot;Long Donations Accepted (Over £50)&quot; 
## [36] &quot;Long Donations Rejected&quot;            
## [37] &quot;Short 3a Unpaid&quot;                    
## [38] &quot;Short 3a Disputed&quot;                  
## [39] &quot;Short 3a Notional&quot;                  
## [40] &quot;Short 3a Payments&quot;                  
## [41] &quot;Short 3a Total&quot;                     
## [42] &quot;Short 3b Advertising&quot;               
## [43] &quot;Short 3b Unsolicited&quot;               
## [44] &quot;Short 3b Transport&quot;                 
## [45] &quot;Short 3b Public Meetings&quot;           
## [46] &quot;Short 3b Agent and Staff&quot;           
## [47] &quot;Short 3b Accommodation&quot;             
## [48] &quot;Short 3b Total&quot;                     
## [49] &quot;Short Personal Expenses&quot;            
## [50] &quot;Short Candidate Money&quot;              
## [51] &quot;Short Donations Accepted (Over £50)&quot;
## [52] &quot;Short Donations Rejected&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spend<span class="fl">.10</span>.sub &lt;-<span class="st"> </span><span class="kw">subset</span>(spend<span class="fl">.10</span>, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">`</span><span class="dt">ConstituencyId</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Party Name</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Spend as % of Short Limit</span><span class="st">`</span>))
spend<span class="fl">.10</span>.sub$ons &lt;-<span class="st"> </span>spend<span class="fl">.10</span>.sub$<span class="st">`</span><span class="dt">ConstituencyId</span><span class="st">`</span>
spend<span class="fl">.10</span>.sub$party &lt;-<span class="st"> </span>spend<span class="fl">.10</span>.sub$<span class="st">`</span><span class="dt">Party Name</span><span class="st">`</span>
spend<span class="fl">.10</span>.sub$shortpct10 &lt;-<span class="st"> </span>spend<span class="fl">.10</span>.sub$<span class="st">`</span><span class="dt">Spend as % of Short Limit</span><span class="st">`</span>
spend<span class="fl">.10</span>.sub$<span class="st">`</span><span class="dt">ConstituencyId</span><span class="st">`</span> &lt;-<span class="st"> </span>spend<span class="fl">.10</span>.sub$<span class="st">`</span><span class="dt">Party Name</span><span class="st">`</span> &lt;-<span class="st"> </span>spend<span class="fl">.10</span>.sub$<span class="st">`</span><span class="dt">Spend as % of Short Limit</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">write.csv</span>(spend<span class="fl">.10</span>.sub, <span class="st">&quot;UK_2010_LONG.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Load the 2015 British Election Study constituency contextual results data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Download (or load if downloaded) from the BES website
url.bes &lt;-<span class="st"> &quot;http://www.britishelectionstudy.com/custom/uploads/2017/03/BES-2015-General-Election-results-file-v2.2.xlsx&quot;</span>
file.bes &lt;-<span class="st"> </span><span class="kw">basename</span>(url.bes)  <span class="co"># Extract the filename</span>
if (!<span class="kw">file.exists</span>(file.bes))   <span class="co"># Only download if not in the working directory</span>
    <span class="kw">download.file</span>(<span class="dt">url =</span> url.bes, <span class="dt">destfile =</span> file.bes, <span class="dt">mode =</span> <span class="st">&quot;wb&quot;</span>)
bes.wide &lt;-<span class="st"> </span><span class="kw">read_excel</span>(file.bes)  <span class="co"># Load the dataset</span>

## Subset the data
<span class="kw">names</span>(bes.wide)</code></pre></div>
<pre><code>##   [1] &quot;pano&quot;                             &quot;ONSConstID&quot;                      
##   [3] &quot;ConstituencyName&quot;                 &quot;Country&quot;                         
##   [5] &quot;Region&quot;                           &quot;ConstituencyType&quot;                
##   [7] &quot;Winner15&quot;                         &quot;Con15&quot;                           
##   [9] &quot;Lab15&quot;                            &quot;LD15&quot;                            
##  [11] &quot;SNP15&quot;                            &quot;PC15&quot;                            
##  [13] &quot;UKIP15&quot;                           &quot;Green15&quot;                         
##  [15] &quot;Other15&quot;                          &quot;Majority15&quot;                      
##  [17] &quot;Turnout15&quot;                        &quot;ConVote15&quot;                       
##  [19] &quot;LabVote15&quot;                        &quot;LDVote15&quot;                        
##  [21] &quot;SNPVote15&quot;                        &quot;PCVote15&quot;                        
##  [23] &quot;UKIPVote15&quot;                       &quot;GreenVote15&quot;                     
##  [25] &quot;BNPVote15&quot;                        &quot;TotalVote15&quot;                     
##  [27] &quot;RejectedVote15&quot;                   &quot;Electorate15&quot;                    
##  [29] &quot;SeatChange1015&quot;                   &quot;Con1015&quot;                         
##  [31] &quot;Lab1015&quot;                          &quot;LD1015&quot;                          
##  [33] &quot;SNP1015&quot;                          &quot;PC1015&quot;                          
##  [35] &quot;UKIP1015&quot;                         &quot;Green1015&quot;                       
##  [37] &quot;Winner10&quot;                         &quot;Con10&quot;                           
##  [39] &quot;Lab10&quot;                            &quot;LD10&quot;                            
##  [41] &quot;SNP10&quot;                            &quot;PC10&quot;                            
##  [43] &quot;UKIP10&quot;                           &quot;Green10&quot;                         
##  [45] &quot;BNP10&quot;                            &quot;Majority10&quot;                      
##  [47] &quot;Turn10&quot;                           &quot;ConVote10&quot;                       
##  [49] &quot;LabVote10&quot;                        &quot;LDVote10&quot;                        
##  [51] &quot;SNPVote10&quot;                        &quot;PCVote10&quot;                        
##  [53] &quot;UKIPVote10&quot;                       &quot;GreenVote10&quot;                     
##  [55] &quot;BNPVote10&quot;                        &quot;TotalVote10&quot;                     
##  [57] &quot;Electorate10&quot;                     &quot;ConPPC&quot;                          
##  [59] &quot;ConPPCsex&quot;                        &quot;ConPPCrace&quot;                      
##  [61] &quot;LabPPC&quot;                           &quot;LabPPCsex&quot;                       
##  [63] &quot;LabPPCrace&quot;                       &quot;LDPPC&quot;                           
##  [65] &quot;LDPPCsex&quot;                         &quot;LDPPCrace&quot;                       
##  [67] &quot;UKIPPPC&quot;                          &quot;UKIPPPCsex&quot;                      
##  [69] &quot;UKIPPPCrace&quot;                      &quot;SNPPPC&quot;                          
##  [71] &quot;SNPPPCsex&quot;                        &quot;SNPPPCrace&quot;                      
##  [73] &quot;PCPPC&quot;                            &quot;PCPPCsex&quot;                        
##  [75] &quot;PCPPCrace&quot;                        &quot;GreenPPC&quot;                        
##  [77] &quot;GreenPPCsex&quot;                      &quot;GreenPPCrace&quot;                    
##  [79] &quot;c11Population&quot;                    &quot;c11PopulationDensity&quot;            
##  [81] &quot;c11Male&quot;                          &quot;c11Female&quot;                       
##  [83] &quot;c11Households&quot;                    &quot;c11Communal&quot;                     
##  [85] &quot;c11Age0to4&quot;                       &quot;c11Age5to7&quot;                      
##  [87] &quot;c11Age8to9&quot;                       &quot;c11Age10to14&quot;                    
##  [89] &quot;c11Age15&quot;                         &quot;c11Age16to17&quot;                    
##  [91] &quot;c11Age18to19&quot;                     &quot;c11Age20to24&quot;                    
##  [93] &quot;c11Age25to29&quot;                     &quot;c11Age30to44&quot;                    
##  [95] &quot;c11Age45to59&quot;                     &quot;c11Age60to64&quot;                    
##  [97] &quot;c11Age65to74&quot;                     &quot;c11Age75to84&quot;                    
##  [99] &quot;c11Age85to89&quot;                     &quot;c11Age90plus&quot;                    
## [101] &quot;c11HouseOwned&quot;                    &quot;c11HouseOutright&quot;                
## [103] &quot;c11HouseMortgage&quot;                 &quot;c11HouseShared&quot;                  
## [105] &quot;c11HouseSocial&quot;                   &quot;c11HouseSocialLA&quot;                
## [107] &quot;c11HouseSocialOther&quot;              &quot;c11HousePrivate&quot;                 
## [109] &quot;c11HousePrivateLandlord&quot;          &quot;c11HousePrivateOther&quot;            
## [111] &quot;c11HouseRentFree&quot;                 &quot;c11HouseholdOnePerson&quot;           
## [113] &quot;c11HouseholdOnePerson65plus&quot;      &quot;c11HouseholdOnePersonOther&quot;      
## [115] &quot;c11HouseholdOneFamily&quot;            &quot;c11HouseholdOneFamily65plus&quot;     
## [117] &quot;c11HouseholdMarried&quot;              &quot;c11HouseholdMarriedNoChildren&quot;   
## [119] &quot;c11HouseholdMarriedDependents&quot;    &quot;c11HouseholdMarriedNondependents&quot;
## [121] &quot;c11HouseholdCohabit&quot;              &quot;c11HouseholdCohabitNoChildren&quot;   
## [123] &quot;c11HouseholdCohabitDependents&quot;    &quot;c11HouseholdCohabitNodependents&quot; 
## [125] &quot;c11HouseholdLone&quot;                 &quot;c11HouseholdLoneDependents&quot;      
## [127] &quot;c11HouseholdLoneNodependents&quot;     &quot;c11HouseholdOther&quot;               
## [129] &quot;c11HouseholdOtherDependents&quot;      &quot;c11HouseholdAllStudents&quot;         
## [131] &quot;c11HouseholdAll65plus&quot;            &quot;c11HouseholdAnyOther&quot;            
## [133] &quot;c11CarsNone&quot;                      &quot;c11CarsOne&quot;                      
## [135] &quot;c11CarsTwo&quot;                       &quot;c11CarsThree&quot;                    
## [137] &quot;c11CarsFour&quot;                      &quot;c11EthnicityWhite&quot;               
## [139] &quot;c11EthnicityMixed&quot;                &quot;c11EthnicityAsian&quot;               
## [141] &quot;c11EthnicityBlack&quot;                &quot;c11EthnicityOther&quot;               
## [143] &quot;c11EthnicityWhiteBritish&quot;         &quot;c11EthnicityWhiteIrish&quot;          
## [145] &quot;c11EthnicityWhiteTraveller&quot;       &quot;c11EthnicityWhiteOther&quot;          
## [147] &quot;c11EthnicityMixedCaribbean&quot;       &quot;c11EthnicityMixedAfrican&quot;        
## [149] &quot;c11EthnicityMixedAsian&quot;           &quot;c11EthnicityMixedOther&quot;          
## [151] &quot;c11EthnicityIndian&quot;               &quot;c11EthnicityPakistani&quot;           
## [153] &quot;c11EthnicityBangladeshi&quot;          &quot;c11EthnicityChinese&quot;             
## [155] &quot;c11EthnicityOtherAsian&quot;           &quot;c11EthnicityBlackAfrican&quot;        
## [157] &quot;c11EthnicityBlackCaribbean&quot;       &quot;c11EthnicityBlackOther&quot;          
## [159] &quot;c11EthnicityArab&quot;                 &quot;c11EthnicityAnyOther&quot;            
## [161] &quot;c11BornUK&quot;                        &quot;c11BornEngland&quot;                  
## [163] &quot;c11BornNI&quot;                        &quot;c11BornScotland&quot;                 
## [165] &quot;c11BornWales&quot;                     &quot;c11BornUKNotSpecified&quot;           
## [167] &quot;c11BornIreland&quot;                   &quot;c11BornOtherEU&quot;                  
## [169] &quot;c11BornOtherPre2004EU&quot;            &quot;c11BornPost2004EU&quot;               
## [171] &quot;c11BornOther&quot;                     &quot;c11PassportNone&quot;                 
## [173] &quot;c11PassportAny&quot;                   &quot;c11PassportUK&quot;                   
## [175] &quot;c11PassportIreland&quot;               &quot;c11PassportEU&quot;                   
## [177] &quot;c11PassportEuropeNotEU&quot;           &quot;c11PassportAfrica&quot;               
## [179] &quot;c11PassportAsia&quot;                  &quot;c11PassportNorthAmerica&quot;         
## [181] &quot;c11PassportCentralAmerica&quot;        &quot;c11PassportSouthAmerica&quot;         
## [183] &quot;c11PassportOceania&quot;               &quot;c11EnglishAll&quot;                   
## [185] &quot;c11EnglishOne&quot;                    &quot;c11EnglishChild&quot;                 
## [187] &quot;c11EnglishNone&quot;                   &quot;c11Christian&quot;                    
## [189] &quot;c11Buddhist&quot;                      &quot;c11Hindu&quot;                        
## [191] &quot;c11Jewish&quot;                        &quot;c11Muslim&quot;                       
## [193] &quot;c11Sikh&quot;                          &quot;c11ReligionOther&quot;                
## [195] &quot;c11NoReligion&quot;                    &quot;c11ReligionNotStated&quot;            
## [197] &quot;c11NSSECHigherManager&quot;            &quot;c11NSSECHigherProfessional&quot;      
## [199] &quot;c11NSSECLowerManager&quot;             &quot;c11NSSECIntermediate&quot;            
## [201] &quot;c11NSSECSmallEmployer&quot;            &quot;c11NSSECLowerSupervisor&quot;         
## [203] &quot;c11NSSECSemiRoutine&quot;              &quot;c11NSSECRoutine&quot;                 
## [205] &quot;c11NSSECNeverWorked&quot;              &quot;c11NSSECLongtermUnemployed&quot;      
## [207] &quot;c11EconomicActive&quot;                &quot;c11Employed&quot;                     
## [209] &quot;c11EmployedPartTime&quot;              &quot;c11EmployedFullTime&quot;             
## [211] &quot;c11SelfEmployed&quot;                  &quot;c11Unemployed&quot;                   
## [213] &quot;c11EconomicallyActiveStudent&quot;     &quot;c11EconomicInactive&quot;             
## [215] &quot;c11Retired&quot;                       &quot;c11EconomicallyInactiveStudent&quot;  
## [217] &quot;c11LookingAfterHome&quot;              &quot;c11LongTermSick&quot;                 
## [219] &quot;c11EconomicInactiveOther&quot;         &quot;c11Unemployed16to24&quot;             
## [221] &quot;c11Unemployed50to74&quot;              &quot;c11Neverworked&quot;                  
## [223] &quot;c11LongTermUnemployed&quot;            &quot;c11FulltimeStudent&quot;              
## [225] &quot;c11IndustryAgriculture&quot;           &quot;c11IndustryMining&quot;               
## [227] &quot;c11IndustryManufacturing&quot;         &quot;c11IndustryElectricitySupply&quot;    
## [229] &quot;c11IndustryWaterSupply&quot;           &quot;c11IndustryConstruction&quot;         
## [231] &quot;c11IndustryWholesale&quot;             &quot;c11IndustryTransport&quot;            
## [233] &quot;c11IndustryAccommodation&quot;         &quot;c11IndustryCommunication&quot;        
## [235] &quot;c11IndustryFinance&quot;               &quot;c11IndustryRealEstate&quot;           
## [237] &quot;c11IndustryProfessional&quot;          &quot;c11IndustryAdministrative&quot;       
## [239] &quot;c11IndustryPublicAdministration&quot;  &quot;c11IndustryEducation&quot;            
## [241] &quot;c11IndustrySocialWork&quot;            &quot;c11IndustryOther&quot;                
## [243] &quot;c11QualNone&quot;                      &quot;c11QualLevel1&quot;                   
## [245] &quot;c11QualLevel2&quot;                    &quot;c11QualApprentice&quot;               
## [247] &quot;c11QualLevel3&quot;                    &quot;c11QualLevel4&quot;                   
## [249] &quot;c11QualOther&quot;                     &quot;c11Degree&quot;                       
## [251] &quot;c11HealthVeryGood&quot;                &quot;c11HealthGood&quot;                   
## [253] &quot;c11HealthFair&quot;                    &quot;c11HealthBad&quot;                    
## [255] &quot;c11HealthVeryBad&quot;                 &quot;c11NoAdultsEmployed&quot;             
## [257] &quot;c11NoAdultsEmployedChildren&quot;      &quot;c11NoAdultsEmployedNoChildren&quot;   
## [259] &quot;c11DeprivedNone&quot;                  &quot;c11Deprived1&quot;                    
## [261] &quot;c11Deprived2&quot;                     &quot;c11Deprived3&quot;                    
## [263] &quot;c11Deprived4&quot;                     &quot;ConLongSpendPercent&quot;             
## [265] &quot;ConShortSpendPercent&quot;             &quot;LabLongSpendPercent&quot;             
## [267] &quot;LabShortSpendPercent&quot;             &quot;LDLongSpendPercent&quot;              
## [269] &quot;LDShortSpendPercent&quot;              &quot;SNPLongSpendPercent&quot;             
## [271] &quot;SNPShortSpendPercent&quot;             &quot;PCLongSpendPercent&quot;              
## [273] &quot;PCShortSpendPercent&quot;              &quot;UKIPLongSpendPercent&quot;            
## [275] &quot;UKIPShortSpendPercent&quot;            &quot;GreenLongSpendPercent&quot;           
## [277] &quot;GreenShortSpendPercent&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bes.wide.sub &lt;-<span class="st"> </span><span class="kw">subset</span>(bes.wide, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;ONSConstID&quot;</span>, <span class="st">&quot;Winner15&quot;</span>, <span class="st">&quot;Winner10&quot;</span>, <span class="st">&quot;Con15&quot;</span>, <span class="st">&quot;Lab15&quot;</span>, 
                                            <span class="st">&quot;LD15&quot;</span>, <span class="st">&quot;SNP15&quot;</span>, <span class="st">&quot;PC15&quot;</span>, <span class="st">&quot;UKIP15&quot;</span>, <span class="st">&quot;Green15&quot;</span>, <span class="st">&quot;Other15&quot;</span>, 
                                            <span class="st">&quot;Con10&quot;</span>, <span class="st">&quot;Lab10&quot;</span>, <span class="st">&quot;LD10&quot;</span>, <span class="st">&quot;SNP10&quot;</span>, <span class="st">&quot;PC10&quot;</span>, 
                                            <span class="st">&quot;UKIP10&quot;</span>, <span class="st">&quot;Green10&quot;</span>, <span class="st">&quot;BNP10&quot;</span>))

## Reshape BES data from wide to long
<span class="kw">names</span>(bes.wide.sub)</code></pre></div>
<pre><code>##  [1] &quot;ONSConstID&quot; &quot;Winner15&quot;   &quot;Winner10&quot;   &quot;Con15&quot;      &quot;Lab15&quot;     
##  [6] &quot;LD15&quot;       &quot;SNP15&quot;      &quot;PC15&quot;       &quot;UKIP15&quot;     &quot;Green15&quot;   
## [11] &quot;Other15&quot;    &quot;Con10&quot;      &quot;Lab10&quot;      &quot;LD10&quot;       &quot;SNP10&quot;     
## [16] &quot;PC10&quot;       &quot;UKIP10&quot;     &quot;Green10&quot;    &quot;BNP10&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(bes.wide.sub) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ons&quot;</span>, <span class="st">&quot;winner15&quot;</span>, <span class="st">&quot;winner10&quot;</span>, <span class="st">&quot;Conservative.v2015&quot;</span>, <span class="st">&quot;Labour.v2015&quot;</span>, 
                            <span class="st">&quot;LibDem.v2015&quot;</span>, <span class="st">&quot;SNP.v2015&quot;</span>, <span class="st">&quot;PC.v2015&quot;</span>, <span class="st">&quot;UKIP.v2015&quot;</span>, <span class="st">&quot;Green.v2015&quot;</span>, 
                            <span class="st">&quot;Other.v2015&quot;</span>, <span class="st">&quot;Conservative.v2010&quot;</span>, <span class="st">&quot;Labour.v2010&quot;</span>, <span class="st">&quot;LibDem.v2010&quot;</span>, 
                            <span class="st">&quot;SNP.v2010&quot;</span>, <span class="st">&quot;PC.v2010&quot;</span>, <span class="st">&quot;UKIP.v2010&quot;</span>, <span class="st">&quot;Green.v2010&quot;</span>, <span class="st">&quot;Other.v2010&quot;</span>)

bes.long &lt;-<span class="st"> </span>
<span class="st">    </span>bes.wide.sub %&gt;%
<span class="st">    </span><span class="kw">gather</span>(key, pct, -ons, -winner15, -winner10) %&gt;%
<span class="st">    </span><span class="kw">separate</span>(key, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;party&quot;</span>, <span class="st">&quot;year&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>) %&gt;%
<span class="st">    </span><span class="kw">spread</span>(year, pct)

<span class="kw">write.csv</span>(bes.long, <span class="st">&quot;UK_BES_LONG.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Load the 2015 British Election Study Wave 1 Internet panel data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Download (or load if downloaded) from the BES website
url.bes2 &lt;-<span class="st"> &quot;http://www.britishelectionstudy.com/custom/uploads/2015/07/BES2015_W1_v5.0.dta&quot;</span>
file.bes2 &lt;-<span class="st"> </span><span class="kw">basename</span>(url.bes2)  <span class="co"># Extract the filename</span>
if (!<span class="kw">file.exists</span>(file.bes2))   <span class="co"># Only download if not in the working directory</span>
    <span class="kw">download.file</span>(<span class="dt">url =</span> url.bes2, <span class="dt">destfile =</span> file.bes2, <span class="dt">mode =</span> <span class="st">&quot;wb&quot;</span>)
bes.panel &lt;-<span class="st"> </span><span class="kw">read_dta</span>(file.bes2)  <span class="co"># Load the dataset</span>

## Subset the data
<span class="kw">names</span>(bes.panel)</code></pre></div>
<pre><code>##   [1] &quot;id&quot;                               &quot;wt_core_W1&quot;                      
##   [3] &quot;wave1&quot;                            &quot;country&quot;                         
##   [5] &quot;starttime&quot;                        &quot;endtime&quot;                         
##   [7] &quot;wt_full_W1&quot;                       &quot;ordering&quot;                        
##   [9] &quot;pidfront&quot;                         &quot;vtfront&quot;                         
##  [11] &quot;getsBrandenburg&quot;                  &quot;getsEUTT&quot;                        
##  [13] &quot;getsHuddy&quot;                        &quot;getsPTV&quot;                         
##  [15] &quot;getsRedistTT&quot;                     &quot;getsTT&quot;                          
##  [17] &quot;playground&quot;                       &quot;condition&quot;                       
##  [19] &quot;pledgeRand&quot;                       &quot;eduChoice&quot;                       
##  [21] &quot;RandomID&quot;                         &quot;ukCitizen&quot;                       
##  [23] &quot;euCitizen&quot;                        &quot;commonwealthCitizen&quot;             
##  [25] &quot;otherCitizen&quot;                     &quot;mii&quot;                             
##  [27] &quot;MII_text&quot;                         &quot;bestOnMII&quot;                       
##  [29] &quot;bestOnMIIOth&quot;                     &quot;turnoutUKGeneral&quot;                
##  [31] &quot;generalElectionVote&quot;              &quot;generalElectionVoteOth&quot;          
##  [33] &quot;generalElectionCertainty&quot;         &quot;partyIdStrength&quot;                 
##  [35] &quot;partyId&quot;                          &quot;partyIdSqueeze&quot;                  
##  [37] &quot;partyIdOth&quot;                       &quot;polAttention&quot;                    
##  [39] &quot;likeCameron&quot;                      &quot;likeMiliband&quot;                    
##  [41] &quot;likeClegg&quot;                        &quot;likeSalmond&quot;                     
##  [43] &quot;likeWood&quot;                         &quot;likeFarage&quot;                      
##  [45] &quot;thatcherGood&quot;                     &quot;blairGood&quot;                       
##  [47] &quot;goodTimePurchase&quot;                 &quot;riskPoverty&quot;                     
##  [49] &quot;riskUnemployment&quot;                 &quot;econPersonalRetro&quot;               
##  [51] &quot;econGenRetro&quot;                     &quot;likeCon&quot;                         
##  [53] &quot;likeLab&quot;                          &quot;likeLD&quot;                          
##  [55] &quot;likeSNP&quot;                          &quot;likePC&quot;                          
##  [57] &quot;likeUKIP&quot;                         &quot;likeGrn&quot;                         
##  [59] &quot;likeBNP&quot;                          &quot;ptvCon&quot;                          
##  [61] &quot;ptvLab&quot;                           &quot;ptvLD&quot;                           
##  [63] &quot;ptvSNP&quot;                           &quot;ptvPC&quot;                           
##  [65] &quot;ptvUKIP&quot;                          &quot;ptvGrn&quot;                          
##  [67] &quot;ptvBNP&quot;                           &quot;responsibleDebtConservatives&quot;    
##  [69] &quot;responsibleDebtLiberalDems&quot;       &quot;responsibleDebtLabour&quot;           
##  [71] &quot;responsibleDebtUKBanks&quot;           &quot;responsibleDebtGlobalBanks&quot;      
##  [73] &quot;responsibleDebtTradeUnions&quot;       &quot;responsibleDebtEU&quot;               
##  [75] &quot;responsibleDebtOther&quot;             &quot;responsibleDebtNone&quot;             
##  [77] &quot;responsibleDebtDontKnow&quot;          &quot;cutsTooFarNational&quot;              
##  [79] &quot;cutsTooFarNHS&quot;                    &quot;cutsTooFarLocal&quot;                 
##  [81] &quot;privatTooFar&quot;                     &quot;enviroProtection&quot;                
##  [83] &quot;changeEconomy&quot;                    &quot;changeNHS&quot;                       
##  [85] &quot;changeEducation&quot;                  &quot;changeCostLive&quot;                  
##  [87] &quot;changeImmig&quot;                      &quot;changeCrime&quot;                     
##  [89] &quot;responsibleEconConservatives&quot;     &quot;responsibleEconLibDems&quot;          
##  [91] &quot;responsibleEconLabour&quot;            &quot;responsibleEconScottishGovt&quot;     
##  [93] &quot;responsibleEconWelshGovt&quot;         &quot;responsibleEconNone&quot;             
##  [95] &quot;responsibleEconDontKnow&quot;          &quot;responsibleNHSConservatives&quot;     
##  [97] &quot;responsibleNHSLibDems&quot;            &quot;responsibleNHSLabour&quot;            
##  [99] &quot;responsibleNHSScottishGovt&quot;       &quot;responsibleNHSWelshGovt&quot;         
## [101] &quot;responsibleNHSNone&quot;               &quot;responsibleNHSDontKnow&quot;          
## [103] &quot;responsibleEducationCon&quot;          &quot;responsibleEducationLD&quot;          
## [105] &quot;responsibleEducationLab&quot;          &quot;responsibleEducationScotGovt&quot;    
## [107] &quot;responsibleEducationWelshGovt&quot;    &quot;responsibleEducationNone&quot;        
## [109] &quot;responsibleEducationDontKnow&quot;     &quot;responsibleCostLiveCon&quot;          
## [111] &quot;responsibleCostLiveLD&quot;            &quot;responsibleCostLiveLab&quot;          
## [113] &quot;responsibleCostLiveScotGovt&quot;      &quot;responsibleCostLiveWelshGovt&quot;    
## [115] &quot;responsibleCostLiveNone&quot;          &quot;responsibleCostLiveDontKnow&quot;     
## [117] &quot;responsibleImmigConservatives&quot;    &quot;responsibleImmigLibDems&quot;         
## [119] &quot;responsibleImmigLabour&quot;           &quot;responsibleImmigScottishGovt&quot;    
## [121] &quot;responsibleImmigWelshGovt&quot;        &quot;responsibleImmigNone&quot;            
## [123] &quot;responsibleImmigDontKnow&quot;         &quot;responsibleCrimeConservatives&quot;   
## [125] &quot;responsibleCrimeLibDems&quot;          &quot;responsibleCrimeLabour&quot;          
## [127] &quot;responsibleCrimeScottishGovt&quot;     &quot;responsibleCrimeWelshGovt&quot;       
## [129] &quot;responsibleCrimeNone&quot;             &quot;responsibleCrimeDontKnow&quot;        
## [131] &quot;changeEconomyLab&quot;                 &quot;changeNHSLab&quot;                    
## [133] &quot;changeEducationLab&quot;               &quot;changeCostLiveLab&quot;               
## [135] &quot;changeImmigLab&quot;                   &quot;changeCrimeLab&quot;                  
## [137] &quot;euroTurnout&quot;                      &quot;euroElectionVote&quot;                
## [139] &quot;euroElectionVoteOth&quot;              &quot;euRefVote&quot;                       
## [141] &quot;eesEUIntegrationSelf&quot;             &quot;eesEUIntegrationCon&quot;             
## [143] &quot;eesEUIntegrationLab&quot;              &quot;eesEUIntegrationLD&quot;              
## [145] &quot;eesEUIntegrationUKIP&quot;             &quot;eesEUIntegrationSNP&quot;             
## [147] &quot;eesEUIntegrationPC&quot;               &quot;EUIntegrationSelf&quot;               
## [149] &quot;EUIntegrationCon&quot;                 &quot;EUIntegrationLab&quot;                
## [151] &quot;EUIntegrationLD&quot;                  &quot;EUIntegrationUKIP&quot;               
## [153] &quot;EUIntegrationSNP&quot;                 &quot;EUIntegrationPC&quot;                 
## [155] &quot;selfEUCertain&quot;                    &quot;certaintyEUCon&quot;                  
## [157] &quot;certaintyEULab&quot;                   &quot;certaintyEULD&quot;                   
## [159] &quot;certaintyEUUKIP&quot;                  &quot;difficultBlameCoalition&quot;         
## [161] &quot;singlePartyEffective&quot;             &quot;coalitionInTune&quot;                 
## [163] &quot;coalitionDontDeliver&quot;             &quot;immigEcon&quot;                       
## [165] &quot;immigCultural&quot;                    &quot;dutyToVote2&quot;                     
## [167] &quot;socialPressureVote&quot;               &quot;efficacyUnderstand&quot;              
## [169] &quot;efficacyTooMuchEffort&quot;            &quot;efficacyNotUnderstand&quot;           
## [171] &quot;efficacyPolCare&quot;                  &quot;redistSelf&quot;                      
## [173] &quot;redistCon&quot;                        &quot;redistLab&quot;                       
## [175] &quot;redistLD&quot;                         &quot;redistUKIP&quot;                      
## [177] &quot;redistSNP&quot;                        &quot;redistPC&quot;                        
## [179] &quot;selfRedistCertain&quot;                &quot;certaintyRedistCon&quot;              
## [181] &quot;certaintyRedistLab&quot;               &quot;certaintyRedistLD&quot;               
## [183] &quot;certaintyRedistUKIP&quot;              &quot;britishness&quot;                     
## [185] &quot;scottishness&quot;                     &quot;welshness&quot;                       
## [187] &quot;englishness&quot;                      &quot;reasonForUnemployment&quot;           
## [189] &quot;immigrantsWelfareState&quot;           &quot;govtHandouts&quot;                    
## [191] &quot;polForTheRich&quot;                    &quot;businessBonus&quot;                   
## [193] &quot;leftRight&quot;                        &quot;satDemUK&quot;                        
## [195] &quot;satDemScot&quot;                       &quot;satDemWales&quot;                     
## [197] &quot;satDemEng&quot;                        &quot;satDemEU&quot;                        
## [199] &quot;scotShareBurden&quot;                  &quot;approveUKGovt&quot;                   
## [201] &quot;approveScotGovt&quot;                  &quot;approveWelshGovt&quot;                
## [203] &quot;scotReferendumOutside&quot;            &quot;scotReferendumIntention&quot;         
## [205] &quot;scotReferendumTurnout&quot;            &quot;happyScotIndepResult&quot;            
## [207] &quot;scotRefExpectation&quot;               &quot;scotRefExpectationTurnout&quot;       
## [209] &quot;scotDevoMax&quot;                      &quot;expectationDevoScot&quot;             
## [211] &quot;expectationDevoWales&quot;             &quot;engFairShare&quot;                    
## [213] &quot;scotFairShare&quot;                    &quot;walesFairShare&quot;                  
## [215] &quot;scotIndepGoodEng&quot;                 &quot;englandGovern&quot;                   
## [217] &quot;devoResponsibleScotWelfare&quot;       &quot;devoResponsibleScotNHS&quot;          
## [219] &quot;devoResponsibleScotSchools&quot;       &quot;devoResponsibleScotDefence&quot;      
## [221] &quot;devoResponsibleScotTax&quot;           &quot;devoResponsibleScotPolice&quot;       
## [223] &quot;scotIndepEconomy&quot;                 &quot;scotIndepInequality&quot;             
## [225] &quot;scotIndepVoice&quot;                   &quot;cooperateRUKGBP&quot;                 
## [227] &quot;scotIndepJoinEU&quot;                  &quot;scotIndepMeBetterOff&quot;            
## [229] &quot;certaintyScotIndependence&quot;        &quot;certaintyScotUnion&quot;              
## [231] &quot;scotElectionVoteConst&quot;            &quot;scotElectionVoteConstOth&quot;        
## [233] &quot;scotIndepGoodWales&quot;               &quot;devoPrefWales&quot;                   
## [235] &quot;devoResponsibleWalesWelfare&quot;      &quot;devoResponsibleWalesNHS&quot;         
## [237] &quot;devoResponsibleWalesSchools&quot;      &quot;devoResponsibleWalesDefence&quot;     
## [239] &quot;devoResponsibleWalesTax&quot;          &quot;devoResponsibleWalesPolice&quot;      
## [241] &quot;devoResponsibleWalesJustice&quot;      &quot;welshElectionVoteConst&quot;          
## [243] &quot;welshElectionVoteConstOth&quot;        &quot;welshElectionVoteList&quot;           
## [245] &quot;welshElectionVoteListOth&quot;         &quot;expectationManipCheck&quot;           
## [247] &quot;pocketBookAccurateDV2&quot;            &quot;econPersonalProsp&quot;               
## [249] &quot;econGenProsp&quot;                     &quot;govtHandleCostLive&quot;              
## [251] &quot;govtHandleEcon&quot;                   &quot;govtHandleImmig&quot;                 
## [253] &quot;govtHandleNHS&quot;                    &quot;govtHandleEduc&quot;                  
## [255] &quot;govtHandleLevelCrime&quot;             &quot;labHandleCostLive&quot;               
## [257] &quot;labHandleEcon&quot;                    &quot;labHandleImmig&quot;                  
## [259] &quot;labHandleNHS&quot;                     &quot;labHandleEduc&quot;                   
## [261] &quot;labHandleLevelCrime&quot;              &quot;minIncomeWellOff&quot;                
## [263] &quot;minIncomeGetBy&quot;                   &quot;incomeWelfare&quot;                   
## [265] &quot;pidWeThey&quot;                        &quot;pidInterestedOthers&quot;             
## [267] &quot;pidCriticiseParty&quot;                &quot;pidCommonParty&quot;                  
## [269] &quot;pidRuinDay&quot;                       &quot;pidConnected&quot;                    
## [271] &quot;pidMyParty&quot;                       &quot;pidPraiseGood&quot;                   
## [273] &quot;promiseHealth&quot;                    &quot;promiseIDCards&quot;                  
## [275] &quot;promiseMigration&quot;                 &quot;promiseRetire&quot;                   
## [277] &quot;promiseTaxAllowance&quot;              &quot;promiseTuition&quot;                  
## [279] &quot;proposalHealth&quot;                   &quot;proposalIDCards&quot;                 
## [281] &quot;proposalMigration&quot;                &quot;proposalRetire&quot;                  
## [283] &quot;proposalTaxAllowance&quot;             &quot;proposalTuition&quot;                 
## [285] &quot;conPriorities_econ&quot;               &quot;conPriorities_costLive&quot;          
## [287] &quot;conPriorities_nhs&quot;                &quot;conPriorities_immig&quot;             
## [289] &quot;conPriorities_crime&quot;              &quot;conPriorities_school&quot;            
## [291] &quot;conPriorities_none&quot;               &quot;labPriorities_econ&quot;              
## [293] &quot;labPriorities_costLive&quot;           &quot;labPriorities_nhs&quot;               
## [295] &quot;labPriorities_immig&quot;              &quot;labPriorities_crime&quot;             
## [297] &quot;labPriorities_school&quot;             &quot;labPriorities_none&quot;              
## [299] &quot;ldPriorities_econ&quot;                &quot;ldPriorities_costLive&quot;           
## [301] &quot;ldPriorities_nhs&quot;                 &quot;ldPriorities_immig&quot;              
## [303] &quot;ldPriorities_crime&quot;               &quot;ldPriorities_school&quot;             
## [305] &quot;ldPriorities_none&quot;                &quot;ukipPriorities_econ&quot;             
## [307] &quot;ukipPriorities_costLive&quot;          &quot;ukipPriorities_nhs&quot;              
## [309] &quot;ukipPriorities_immig&quot;             &quot;ukipPriorities_crime&quot;            
## [311] &quot;ukipPriorities_school&quot;            &quot;ukipPriorities_none&quot;             
## [313] &quot;partyContact1new&quot;                 &quot;partyContactCon&quot;                 
## [315] &quot;partyContactLab&quot;                  &quot;partyContactLD&quot;                  
## [317] &quot;partyContactPC&quot;                   &quot;partyContactUKIP&quot;                
## [319] &quot;partyContactOtherParty&quot;           &quot;partyContactNone&quot;                
## [321] &quot;partyContactDK&quot;                   &quot;othContact&quot;                      
## [323] &quot;partyContactCon_1&quot;                &quot;partyContactCon_2&quot;               
## [325] &quot;partyContactCon_3&quot;                &quot;partyContactCon_4&quot;               
## [327] &quot;partyContactCon_5&quot;                &quot;partyContactCon_6&quot;               
## [329] &quot;partyContactCon_7&quot;                &quot;partyContactLab_1&quot;               
## [331] &quot;partyContactLab_2&quot;                &quot;partyContactLab_3&quot;               
## [333] &quot;partyContactLab_4&quot;                &quot;partyContactLab_5&quot;               
## [335] &quot;partyContactLab_6&quot;                &quot;partyContactLab_7&quot;               
## [337] &quot;partyContactLD_1&quot;                 &quot;partyContactLD_2&quot;                
## [339] &quot;partyContactLD_3&quot;                 &quot;partyContactLD_4&quot;                
## [341] &quot;partyContactLD_5&quot;                 &quot;partyContactLD_6&quot;                
## [343] &quot;partyContactLD_7&quot;                 &quot;partyContactPC_1&quot;                
## [345] &quot;partyContactPC_2&quot;                 &quot;partyContactPC_3&quot;                
## [347] &quot;partyContactPC_4&quot;                 &quot;partyContactPC_5&quot;                
## [349] &quot;partyContactPC_6&quot;                 &quot;partyContactPC_7&quot;                
## [351] &quot;partyContactUKIP_1&quot;               &quot;partyContactUKIP_2&quot;              
## [353] &quot;partyContactUKIP_3&quot;               &quot;partyContactUKIP_4&quot;              
## [355] &quot;partyContactUKIP_5&quot;               &quot;partyContactUKIP_6&quot;              
## [357] &quot;partyContactUKIP_7&quot;               &quot;partyContactOther_1&quot;             
## [359] &quot;partyContactOther_2&quot;              &quot;partyContactOther_3&quot;             
## [361] &quot;partyContactOther_4&quot;              &quot;partyContactOther_5&quot;             
## [363] &quot;partyContactOther_6&quot;              &quot;partyContactOther_7&quot;             
## [365] &quot;conUnited&quot;                        &quot;labUnited&quot;                       
## [367] &quot;ldUnited&quot;                         &quot;pcUnited&quot;                        
## [369] &quot;ukipUnited&quot;                       &quot;mpName&quot;                          
## [371] &quot;knowMP&quot;                           &quot;knowMPOth&quot;                       
## [373] &quot;countryOfBirth&quot;                   &quot;selfOccSupervise&quot;                
## [375] &quot;selfOccOrgSize&quot;                   &quot;selfOccEmployees&quot;                
## [377] &quot;selfOccSuperviseLast&quot;             &quot;selfOccOrgSizeLast&quot;              
## [379] &quot;selfOccEmployeesLast&quot;             &quot;generalElecCertainty&quot;            
## [381] &quot;miilabelcertainty&quot;                &quot;miilabel&quot;                        
## [383] &quot;work_type&quot;                        &quot;ageGroup&quot;                        
## [385] &quot;w1full&quot;                           &quot;w1core&quot;                          
## [387] &quot;pano&quot;                             &quot;onscode&quot;                         
## [389] &quot;constituencyid&quot;                   &quot;regionpcon&quot;                      
## [391] &quot;electoratepcon&quot;                   &quot;consh10pcon&quot;                     
## [393] &quot;ldsh10pcon&quot;                       &quot;grnsh10pcon&quot;                     
## [395] &quot;labsh10pcon&quot;                      &quot;pcsh10pcon&quot;                      
## [397] &quot;ukipsh10pcon&quot;                     &quot;bnpsh10pcon&quot;                     
## [399] &quot;snpsh10pcon&quot;                      &quot;othersh10pcon&quot;                   
## [401] &quot;winnersh10pcon&quot;                   &quot;runnerupsh10pcon&quot;                
## [403] &quot;marginsh10pcon&quot;                   &quot;turnout10pcon&quot;                   
## [405] &quot;runnerup10pcon&quot;                   &quot;winner10pcon&quot;                    
## [407] &quot;gender&quot;                           &quot;Age&quot;                             
## [409] &quot;marital&quot;                          &quot;housing&quot;                         
## [411] &quot;gor&quot;                              &quot;education&quot;                       
## [413] &quot;pcon&quot;                             &quot;profile_education_age&quot;           
## [415] &quot;profile_ethnicity&quot;                &quot;profile_lea&quot;                     
## [417] &quot;profile_oslaua&quot;                   &quot;profile_gross_household&quot;         
## [419] &quot;profile_gross_personal&quot;           &quot;profile_household_size&quot;          
## [421] &quot;profile_household_children&quot;       &quot;profile_newspaper_readership_201&quot;
## [423] &quot;profile_past_vote_2005&quot;           &quot;profile_past_vote_2010&quot;          
## [425] &quot;profile_religion&quot;                 &quot;profile_religion_denom&quot;          
## [427] &quot;personality_agreeableness&quot;        &quot;personality_conscientiousness&quot;   
## [429] &quot;personality_extraversion&quot;         &quot;personality_neuroticism&quot;         
## [431] &quot;personality_openness&quot;             &quot;ns_sec&quot;                          
## [433] &quot;ns_sec_analytic&quot;                  &quot;soc2010&quot;                         
## [435] &quot;lr1&quot;                              &quot;lr2&quot;                             
## [437] &quot;lr3&quot;                              &quot;lr4&quot;                             
## [439] &quot;lr5&quot;                              &quot;al1&quot;                             
## [441] &quot;al2&quot;                              &quot;al3&quot;                             
## [443] &quot;al4&quot;                              &quot;al5&quot;                             
## [445] &quot;blackEquality&quot;                    &quot;femaleEquality&quot;                  
## [447] &quot;gayEquality&quot;                      &quot;socialDesScale&quot;                  
## [449] &quot;socialDes_1&quot;                      &quot;socialDes_2&quot;                     
## [451] &quot;socialDes_3&quot;                      &quot;socialDes_4&quot;                     
## [453] &quot;socialDes_none&quot;                   &quot;socialDes_dk&quot;                    
## [455] &quot;riskTaking&quot;                       &quot;privatePrimarySchool&quot;            
## [457] &quot;privateSecondarySchool&quot;           &quot;neverPrivateSchool&quot;              
## [459] &quot;RPrivSchnew_dk&quot;                   &quot;workingStatus&quot;                   
## [461] &quot;preschoolChildrenInHousehold&quot;     &quot;schoolChildrenInHousehold&quot;       
## [463] &quot;sickOrElderlyInHousehold&quot;         &quot;noDependentsInHousehold&quot;         
## [465] &quot;speakWelsh&quot;                       &quot;prevJob&quot;                         
## [467] &quot;selfNumEmployees&quot;                 &quot;selfNumEmployeesLast&quot;            
## [469] &quot;headHouseholdPast&quot;                &quot;fatherNumEmployees&quot;              
## [471] &quot;motherNumEmployees&quot;               &quot;selfOccStatus&quot;                   
## [473] &quot;selfOccStatusLast&quot;                &quot;polKnowMiliband&quot;                 
## [475] &quot;polKnowClegg&quot;                     &quot;polKnowOsborne&quot;                  
## [477] &quot;polKnowMay&quot;                       &quot;polKnowBercow&quot;                   
## [479] &quot;subjectHE&quot;                        &quot;subjectHECurrent&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bes.panel.sub &lt;-<span class="st"> </span><span class="kw">subset</span>(bes.panel, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;onscode&quot;</span>, <span class="st">&quot;wt_full_W1&quot;</span>, <span class="st">&quot;generalElectionVote&quot;</span>))
<span class="kw">colnames</span>(bes.panel.sub) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ons&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;intention&quot;</span>)
bes.panel.sub &lt;-<span class="st"> </span><span class="kw">na.omit</span>(bes.panel.sub)
bes.panel.sub$con.intent &lt;-<span class="st"> </span><span class="kw">ifelse</span>(bes.panel.sub$intention ==<span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)
bes.panel.sub$lab.intent &lt;-<span class="st"> </span><span class="kw">ifelse</span>(bes.panel.sub$intention ==<span class="st"> </span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)
bes.panel.sub$ld.intent &lt;-<span class="st"> </span><span class="kw">ifelse</span>(bes.panel.sub$intention ==<span class="st"> </span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)

## Generate constituency-level vote intetion
svy.weight &lt;-<span class="st"> </span><span class="kw">svydesign</span>(<span class="dt">ids =</span> ~<span class="dv">1</span>, <span class="dt">data =</span> bes.panel.sub, <span class="dt">weights =</span> bes.panel.sub$weight)
con.intent.pct &lt;-<span class="st"> </span><span class="kw">svyby</span>(~con.intent, <span class="dt">by =</span> ~ons, svymean, <span class="dt">design =</span> svy.weight)
lab.intent.pct &lt;-<span class="st"> </span><span class="kw">svyby</span>(~lab.intent, <span class="dt">by =</span> ~ons, svymean, <span class="dt">design =</span> svy.weight)
ld.intent.pct &lt;-<span class="st"> </span><span class="kw">svyby</span>(~ld.intent, <span class="dt">by =</span> ~ons, svymean, <span class="dt">design =</span> svy.weight)

vote.intent &lt;-<span class="st"> </span><span class="kw">merge</span>(con.intent.pct, lab.intent.pct, <span class="dt">by =</span> <span class="st">&quot;ons&quot;</span>)
vote.intent &lt;-<span class="st"> </span><span class="kw">merge</span>(vote.intent, ld.intent.pct, <span class="dt">by =</span> <span class="st">&quot;ons&quot;</span>)

vote.intent$con.intent &lt;-<span class="st"> </span>vote.intent$con.intent*<span class="dv">100</span>
vote.intent$lab.intent &lt;-<span class="st"> </span>vote.intent$lab.intent*<span class="dv">100</span>
vote.intent$ld.intent &lt;-<span class="st"> </span>vote.intent$ld.intent*<span class="dv">100</span>

<span class="kw">names</span>(vote.intent)</code></pre></div>
<pre><code>## [1] &quot;ons&quot;        &quot;con.intent&quot; &quot;se.x&quot;       &quot;lab.intent&quot; &quot;se.y&quot;      
## [6] &quot;ld.intent&quot;  &quot;se&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vote.intent$se.x &lt;-<span class="st"> </span>vote.intent$se.y &lt;-<span class="st"> </span>vote.intent$se &lt;-<span class="st"> </span><span class="ot">NULL</span>

<span class="kw">write.csv</span>(vote.intent, <span class="st">&quot;BES_Vote_Intention_Wave_1_2014.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Load the 2014-2015 Ashcroft polling data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Download (or load if downloaded) from Github
url.polls &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/tkhartman/replication-ashcroft-polling-campaign-spending/master/Ashcroft_Poll_Results_Final.csv&quot;</span>
file.polls &lt;-<span class="st"> </span><span class="kw">basename</span>(url.polls)  <span class="co"># Extract the filename</span>
if (!<span class="kw">file.exists</span>(file.polls))   <span class="co"># Only download if not in the working directory</span>
  <span class="kw">download.file</span>(<span class="dt">url =</span> url.polls, <span class="dt">destfile =</span> file.polls, <span class="dt">mode =</span> <span class="st">&quot;wb&quot;</span>)
polls.wide &lt;-<span class="st"> </span><span class="kw">read.csv</span>(file.polls) <span class="co"># Author coded file</span>

## Reshape Ashcroft data from wide to long
<span class="kw">names</span>(polls.wide)</code></pre></div>
<pre><code>##  [1] &quot;ONSConstID&quot; &quot;polls&quot;      &quot;date.1&quot;     &quot;con.1&quot;      &quot;lab.1&quot;     
##  [6] &quot;ld.1&quot;       &quot;snp.1&quot;      &quot;ukip.1&quot;     &quot;grn.1&quot;      &quot;oth.1&quot;     
## [11] &quot;date_2&quot;     &quot;con.2&quot;      &quot;lab.2&quot;      &quot;ld.2&quot;       &quot;snp.2&quot;     
## [16] &quot;ukip.2&quot;     &quot;grn.2&quot;      &quot;oth.2&quot;      &quot;date_3&quot;     &quot;con.3&quot;     
## [21] &quot;lab.3&quot;      &quot;ld.3&quot;       &quot;snp.3&quot;      &quot;ukip.3&quot;     &quot;grn.3&quot;     
## [26] &quot;oth.3&quot;      &quot;date_4&quot;     &quot;con.4&quot;      &quot;lab.4&quot;      &quot;ld.4&quot;      
## [31] &quot;snp.4&quot;      &quot;ukip.4&quot;     &quot;grn.4&quot;      &quot;oth.4&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">polls.long &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">reshape</span>(polls.wide, 
            <span class="dt">direction =</span> <span class="st">&quot;long&quot;</span>,
            <span class="dt">varying =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">4</span>:<span class="dv">10</span>), <span class="kw">c</span>(<span class="dv">12</span>:<span class="dv">18</span>), <span class="kw">c</span>(<span class="dv">20</span>:<span class="dv">26</span>), <span class="kw">c</span>(<span class="dv">28</span>:<span class="dv">34</span>)), 
            <span class="dt">timevar =</span> <span class="st">&quot;party&quot;</span>,
            <span class="dt">v.names=</span><span class="kw">c</span>(<span class="st">&quot;poll.1&quot;</span>, <span class="st">&quot;poll.2&quot;</span>, <span class="st">&quot;poll.3&quot;</span>, <span class="st">&quot;poll.4&quot;</span>),
            <span class="dt">times =</span> <span class="kw">c</span>(<span class="st">&quot;Conservative&quot;</span>, <span class="st">&quot;Labour&quot;</span>, <span class="st">&quot;LibDem&quot;</span>, <span class="st">&quot;SNP&quot;</span>, <span class="st">&quot;UKIP&quot;</span>, <span class="st">&quot;Green&quot;</span>, <span class="st">&quot;Other&quot;</span>))
<span class="kw">row.names</span>(polls.long) &lt;-<span class="st"> </span>polls.long$id &lt;-<span class="st"> </span><span class="ot">NULL</span>
polls.long$ons &lt;-<span class="st"> </span>polls.long$ONSConstID
polls.long$ONSConstID &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw">write.csv</span>(polls.long, <span class="st">&quot;Ashcroft_LONG.csv&quot;</span>)</code></pre></div>
<p>Merge datasets</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Remove extraneous parties from the 2015 spending data
<span class="kw">table</span>(spend<span class="fl">.15</span>.sub$party)</code></pre></div>
<pre><code>## 
##                            Action on Digital Addiction and Cyberstalking 
##                                                                        1 
##                                               Al-Zebabist Nation of Ooog 
##                                                                        1 
##                                                       All People's Party 
##                                                                        4 
##                            Alliance - Alliance Party of Northern Ireland 
##                                                                       18 
##                                             Alliance For Green Socialism 
##                                                                        4 
##                                                     Animal Welfare Party 
##                                                                        4 
##                                      Apni Party [De-registered 07/01/16] 
##                                                                        1 
##                                                     Apolitical Democrats 
##                                                                        1 
##                                              Beer, Baccy and Scratchings 
##                                                                        1 
##                                         Bournemouth Independent Alliance 
##                                                                        1 
##                                                 British Democratic Party 
##                                                                        1 
##                                                     British Independents 
##                                                                        1 
##                          British National Party [De-registered 08/01/16] 
##                                                                        8 
##                                        Campaign [De-registered 30/06/15] 
##                                                                        1 
##                                           Cannabis is Safer than Alcohol 
##                                                                       32 
##                                                     Children of the Atom 
##                                                                        1 
##                                     Christian Movement for Great Britain 
##                                                                        1 
## Christian Party &quot;Proclaiming Christ's Lordship&quot; [De-registered 04/11/15] 
##                                                                        9 
##                                               Christian Peoples Alliance 
##                                                                       17 
##                                       Class War [De-registered 06/07/15] 
##                                                                        7 
##                                                       Common Sense Party 
##                                                                        1 
##                                       Communist League Election Campaign 
##                                                                        2 
##                                               Communist Party of Britain 
##                                                                        9 
##                                                 Communities United Party 
##                                                                        5 
##                                                                Consensus 
##                                                                        1 
##                                          Conservative and Unionist Party 
##                                                                       16 
##                                                       Conservative Party 
##                                                                      631 
##                                                  Democratic Reform Party 
##                                                                        1 
##                                       Democratic Unionist Party - D.U.P. 
##                                                                       16 
##                               Digital Democracy [De-registered 09/02/16] 
##                                                                        1 
##                                                        English Democrats 
##                                                                       32 
##                                 Europeans Party [De-registered 04/11/15] 
##                                                                        1 
##                     Free Public Transport Party [De-registered 28/07/15] 
##                                                                        1 
##                                                        Give Me Back Elmo 
##                                                                        1 
##                                                              Green Party 
##                                                                      542 
##                                                Guildford Greenbelt Group 
##                                                                        1 
##                                                               Hoi Polloi 
##                                                                        1 
##                                                                 Humanity 
##                                                                        1 
##                                                 Independence from Europe 
##                                                                        5 
##                                                              Independent 
##                                                                      170 
##                    Independent Kidderminster Hospital and Health Concern 
##                                                                        1 
##                                    Independent Save Withybush Save Lives 
##                                                                        1 
##                                                 Independents for Bristol 
##                                                                        1 
##                                                Islam Zinda Baad Platform 
##                                                                        1 
##                                                   Justice For Men &amp; Boys 
##                                                                        2 
##                              Keep It Real Party [De-registered 02/07/15] 
##                                                                        1 
##                                                             Labour Party 
##                                                                      600 
##                                        Labour Party / Co-operative Party 
##                                                                       31 
##                                      Land Party [De-registered 04/11/15] 
##                                                                        1 
##                                                               Left Unity 
##                                                                        3 
##                                            Lewisham People Before Profit 
##                                                                        2 
##                                                        Liberal Democrats 
##                                                                      631 
##                                                               Liberty GB 
##                                                                        3 
##                             Lincolnshire Independents Lincolnshire First 
##                                                                        5 
##                             Magna Carta Conservation Party Great Britain 
##                                                                        1 
##                                                               Mainstream 
##                                                                        1 
##                                        Manston Airport Independent Party 
##                                                                        1 
##                                   Mebyon Kernow - The Party for Cornwall 
##                                                                        6 
##                                   Movement for Active Democracy (M.A.D.) 
##                                                                        1 
##                                                           National Front 
##                                                                        7 
##                                             National Health Action Party 
##                                                                       11 
##                                 National Liberal Party - True Liberalism 
##                                                                        2 
##                                              New Independent Centralists 
##                                                                        1 
##                                      Official Monster Raving Loony Party 
##                                                                       16 
##                                                Party for a United Thanet 
##                                                                        2 
##                                                         Party of Dissent 
##                                                                        1 
##                                                                   Patria 
##                                                                        2 
##                       Patriotic Socialist Party [De-registered 05/01/16] 
##                                                                        2 
##                                            People Before Profit Alliance 
##                                                                        1 
##                                             People First - Gwerin Gyntaf 
##                                                                        1 
##                                                          Pirate Party UK 
##                                                                        6 
##                                         Plaid Cymru - The Party of Wales 
##                                                                       40 
##                             Population Party UK [De-registered 02/07/15] 
##                                                                        1 
##                                                   Putting Croydon First! 
##                                                                        1 
##                                                      Rebooting Democracy 
##                                                                        1 
##                                               Red Flag - Anti-Corruption 
##                                                                        2 
##                             Reduce VAT in Sport [De-registered 14/09/15] 
##                                                                        1 
##                                                 Residents for Uttlesford 
##                                                                        1 
##                                   Restore the Family For Children's Sake 
##                                                                        1 
##                                                     Rochdale First Party 
##                                                                        1 
##                                                 Save Hartlepool Hospital 
##                                                                        1 
##                                                     Scottish Green Party 
##                                                                       31 
##                                            Scottish National Party (SNP) 
##                                                                       59 
##                                                 Scottish Socialist Party 
##                                                                        4 
##                                  SDLP (Social Democratic &amp; Labour Party) 
##                                                                       18 
##                                                                Sinn Féin 
##                                                                       18 
##                                                  Social Democratic Party 
##                                                                        2 
##                                                 Socialist Equality Party 
##                                                                        2 
##                                                   Socialist Labour Party 
##                                                                        8 
##                                                            Something New 
##                                                                        2 
##                             The 30-50 Coalition [De-registered 06/11/15] 
##                                                                        1 
##                                               The Above and Beyond Party 
##                                                                        5 
##                              The Birthday Party [De-registered 12/11/15] 
##                                                                        1 
##                                                         The Change Party 
##                                                                        1 
##                                                     The Democratic Party 
##                                                                        1 
##                                     The Eccentric Party of Great Britain 
##                                                                        1 
##                                                      The Evolution Party 
##                                                                        1 
##                                 The Independent Political Alliance Party 
##                                                                        1 
##                                      The Justice &amp; Anti-Corruption Party 
##                                                                        2 
##                                                        The Liberal Party 
##                                                                        4 
##                                                    The Magna Carta Party 
##                                                                        1 
##                                                 The New Society of Worth 
##                                                                        1 
##                                                     The North East Party 
##                                                                        4 
##                                                       The Northern Party 
##                                                                        3 
##                                          The Party for Poole People Ltd. 
##                                                                        1 
##                     The Peace Party - Non-violence, Justice, Environment 
##                                                                        4 
##                               The Pilgrim Party [De-registered 28/01/16] 
##                                                                        1 
##                                         The Principles of Politics Party 
##                                                                        1 
##                                                      The Realists' Party 
##                                                                        1 
##                                           The Republican Socialist Party 
##                                                                        1 
##                                                        The Respect Party 
##                                                                        4 
##                            The Roman Party. Ave [De-registered 14/09/15] 
##                                                                        1 
##                                     The Socialist Party of Great Britain 
##                                                                       10 
##                                                      The Southport Party 
##                                                                        1 
##                                          The Speaker Seeking Re-election 
##                                                                        1 
##                                         The Sustainable Population Party 
##                                                                        1 
##                                                    The U(niversal) Party 
##                                                                        1 
##                                       The UK Progressive Democracy Party 
##                                                                        1 
##                                                           The Whig Party 
##                                                                        4 
##                                                        The Workers Party 
##                                                                        5 
##                                   Trade Unionist and Socialist Coalition 
##                                                                      128 
##                      Trade Unionist and Socialist Coalition / Left Unity 
##                                                                        7 
##                                         Traditional Unionist Voice - TUV 
##                                                                        7 
##                                                             Ubuntu Party 
##                                                                        2 
##                                             UK Independence Party (UKIP) 
##                                                                      624 
##                                                    Ulster Unionist Party 
##                                                                       15 
##                                                          Vapers in Power 
##                                                                        2 
##                               War Veteran's Pro-Traditional Family Party 
##                                                                        1 
##                                                 We Are The Reality Party 
##                                                                        3 
##                                                      Wessex Regionalists 
##                                                                        1 
##                                                       Wigan Independents 
##                                                                        1 
##                                              Workers Revolutionary Party 
##                                                                        7 
##                                                 World Peace Through Song 
##                                                                        1 
##                                                          Yorkshire First 
##                                                                       14 
##                                                 Young People's Party YPP 
##                                                                        2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">party<span class="fl">.15</span>.keep &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Conservative Party&quot;</span>, <span class="st">&quot;Green Party&quot;</span>, <span class="st">&quot;Labour Party&quot;</span>,
                <span class="st">&quot;Labour Party / Co-operative Party&quot;</span>, <span class="st">&quot;Liberal Democrats&quot;</span>, <span class="st">&quot;Plaid Cymru - The Party of Wales&quot;</span>,
                <span class="st">&quot;Scottish National Party (SNP)&quot;</span>, <span class="st">&quot;UK Independence Party (UKIP)&quot;</span>)

spend<span class="fl">.15</span>.sub &lt;-<span class="st"> </span><span class="kw">subset</span>(spend<span class="fl">.15</span>.sub, party %in%<span class="st"> </span>party<span class="fl">.15</span>.keep)

## Remove extraneous parties from the 2010 spending data
<span class="kw">table</span>(spend<span class="fl">.10</span>.sub$party)</code></pre></div>
<pre><code>## 
##                                &quot;Christian Party &quot;&quot;Proclaiming Christ's Lordship&quot;&quot; 
##                                                                                65 
##                            &quot;Clause 28, Children's Protection Christian Democrats&quot; 
##                                                                                 1 
##                                           &quot;National Liberal Party, The Third Way&quot; 
##                                                                                 1 
##                            &quot;The Peace Party - Non-violence, Justice, Environment&quot; 
##                                                                                 3 
##                                                   A Vote Against MP Expense Abuse 
##                                                                                 1 
##                                                               All The South Party 
##                                                                                 1 
##                                     Alliance - Alliance Party of Northern Ireland 
##                                                                                18 
##                                                      Alliance For Green Socialism 
##                                                                                 6 
##                                                     Alliance for Workers' Liberty 
##                                                                                 1 
##                                                                     Animals Count 
##                                                                                 1 
##                                                   Anticapitalists - Workers Power 
##                                                                                 1 
##                                                              Apolitical Democrats 
##                                                                                 1 
##                                                               Best of a Bad Bunch 
##                                                                                 2 
##                                                            Blue Environment Party 
##                                                                                 1 
##                                                            British National Party 
##                                                                               326 
##                                               Bromsgrove Independent Conservative 
##                                                                                 1 
##                                                         Bushra Irfan of Blackburn 
##                                                                                 1 
##                                                              Cambridge Socialists 
##                                                                                 1 
##                                              Christian Movement for Great Britain 
##                                                                                 2 
##                                                        Christian Peoples Alliance 
##                                                                                15 
##                                                      Church of the Militant Elvis 
##                                                                                 1 
##                                           Citizens for Undead Rights and Equality 
##                                                                                 4 
##                                                                 City INDEPENDENTS 
##                                                                                 1 
##                                                                       Common Good 
##                                                                                 1 
##                                                                Common Sense Party 
##                                                                                 2 
##                                                Communist League Election Campaign 
##                                                                                 2 
##                                                        Communist Party of Britain 
##                                                                                 6 
##                                                   Conservative and Unionist Party 
##                                                                               630 
##                             Conservative and Unionist Party/Ulster Unionist Party 
##                                                                                17 
##                                                                   Cut The Deficit 
##                                                                                 1 
##                                                           Democratic Labour Party 
##                                                                                 1 
##                                                           Democratic Nationalists 
##                                                                                 2 
##                                                Democratic Unionist Party - D.U.P. 
##                                                                                16 
##                                                Direct Democracy (Communist) Party 
##                                                                                 1 
##                                                           English Democrats Party 
##                                                                                94 
##                                                        English Independence Party 
##                                                                                 1 
##                                                          Equal Parenting Alliance 
##                                                                                 2 
##                                                                 Fancy Dress Party 
##                                                                                 1 
##                                                        Freedom and Responsibility 
##                                                                                 1 
##                                                         Get Snouts Out The Trough 
##                                                                                 1 
##                                                                       Green Party 
##                                                                               309 
##                                                   Hugh Salmon for Battersea Party 
##                                                                                 1 
##                                                                          Humanity 
##                                                                                 1 
##                                                                      Impact Party 
##                                                                                 3 
##                                                                       Independent 
##                                                                               292 
##                              Independent Ealing Acton Communities Public Services 
##                                                                                 1 
##                             Independent Kidderminster Hospital and Health Concern 
##                                                                                 1 
##                                                 INDEPENDENT Leave-the-EU Alliance 
##                                                                                 1 
##                                                       Independent People Together 
##                                                                                 1 
##                                                   Independent Save Our Green Belt 
##                                                                                 1 
##                                                     Independent Voice for Halifax 
##                                                                                 1 
##                                                        Independents Federation UK 
##                                                                                 4 
##                                        Independents to Save Queen Mary's Hospital 
##                                                                                 1 
##                                                                      Integrity UK 
##                                                                                 1 
##                                                         Islam Zinda Baad Platform 
##                                                                                 1 
##                                                 Jannen will put Brent North First 
##                                                                                 1 
##                                                                     Justice Party 
##                                                                                 1 
##                                                                      Labour Party 
##                                                                               587 
##                                                   Labour Party/Co-operative Party 
##                                                                                43 
##                                                                        Land Party 
##                                                                                 1 
##                                                     Lewisham People Before Profit 
##                                                                                 1 
##                                                                 Liberal Democrats 
##                                                                               630 
##                                                                 Libertarian Party 
##                                                                                 2 
##                                      Lincolnshire Independents Lincolnshire First 
##                                                                                 3 
##                                       Local Liberals People Before Politics Party 
##                                                                                 1 
##                                                       Mansfield Independent Forum 
##                                                                                 1 
##                                    Matriarchal Party United Kingdom Great Britain 
##                                                                                 1 
##                                            Mebyon Kernow - The Party for Cornwall 
##                                                                                 6 
##                                                          Medway Independent Party 
##                                                                                 1 
##                                                              Middle England Party 
##                                                                                 1 
##                                                                Money Reform Party 
##                                                                                 1 
##                                            Movement for Active Democracy (M.A.D.) 
##                                                                                 1 
##                                                                    National Front 
##                                                                                15 
##                                                           Nationwide Reform Party 
##                                                                                 1 
##                                               Neath Port Talbot Independent Party 
##                                                                                 1 
##                                   New Independent Conservative Chelsea and Fulham 
##                                                                                 1 
##                                                         New Millennium Bean Party 
##                                                                                 1 
##                                                    No Candidate Deserves My Vote! 
##                                                                                 1 
##                                                                      Nobody Party 
##                                                                                 1 
##                                            Northampton - Save Our Public Services 
##                                                                                 1 
##                                               Official Monster Raving Loony Party 
##                                                                                24 
##                                                     People Before Profit Alliance 
##                                                                                 1 
##                                                                    People's Voice 
##                                                                                 1 
##                                                               Peoples Party Essex 
##                                                                                 1 
##                                                                   Pirate Party UK 
##                                                                                 7 
##                                                  Plaid Cymru - The Party of Wales 
##                                                                                40 
##                                                                Reduce Tax On Beer 
##                                                                                 1 
##                                                                 Reform 2000 Party 
##                                                                                 1 
##                                                                 Restoration Party 
##                                                                                 1 
##                          Revolutionary Communist Party Britain (Marxist-Leninist) 
##                                                                                 1 
##                                                         Save King George Hospital 
##                                                                                 1 
##                                                              Scottish Green Party 
##                                                                                20 
##                                                     Scottish National Party (SNP) 
##                                                                                59 
##                                                          Scottish Socialist Party 
##                                                                                10 
##                                                          Scrap Members Allowances 
##                                                                                 2 
##                                           SDLP (Social Democratic &amp; Labour Party) 
##                                                                                18 
##                                                                         Sinn FÚin 
##                                                                                17 
##                                                           Social Democratic Party 
##                                                                                 2 
##                                                             Socialist Alternative 
##                                                                                 4 
##                                                          Socialist Equality Party 
##                                                                                 2 
##                                                            Socialist Labour Party 
##                                                                                22 
##                                        Solihull and Meriden Residents Association 
##                                                                                 2 
##                                                   Staffordshire Independent Group 
##                                                                                 1 
##                                                       Tamsin Omond To The Commons 
##                                                                                 1 
##                                                                    Tendring First 
##                                                                                 1 
##                                                       The Animal Protection Party 
##                                                                                 4 
##                                        The Buckinghamshire Campaign for Democracy 
##                                                                                 1 
##                                                             The Cornish Democrats 
##                                                                                 1 
##                                                                   The Joy of Talk 
##                                                                                 1 
##                                               The Justice &amp; Anti-Corruption Party 
##                                                                                 2 
##                                                                 The Liberal Party 
##                                                                                 5 
##                                                      The Macclesfield Independent 
##                                                                                 1 
##                                                                     The New Party 
##                                                                                 1 
##                                                                      The P.N.D.P. 
##                                                                                 1 
##                                                                 The Respect Party 
##                                                                                10 
##                                                                 The Science Party 
##                                                                                 1 
##                                              The Socialist Party of Great Britain 
##                                                                                 1 
##                                                                       The Speaker 
##                                                                                 1 
##                                                   The True English (Poetry) Party 
##                                                                                 1 
##                                                                   The Youth Party 
##                                                                                 1 
##                                            Trade Unionist and Socialist Coalition 
##                                                                                31 
## Trade Unionist and Socialist Coalition/Solidarity - Scotland's Socialist Movement 
##                                                                                 4 
##                                                  Traditional Unionist Voice - TUV 
##                                                                                10 
##                                                                             Trust 
##                                                                                 2 
##                                                    UK Independence Party (UK I P) 
##                                                                               540 
##                                                                      United Voice 
##                                                                                 1 
##                                                     Unity For Peace And Socialism 
##                                                                                 1 
##                                         Virtue Currency Cognitive Appraisal Party 
##                                                                                 1 
##                                                               Wessex Regionalists 
##                                                                                 1 
##                                                       Workers Revolutionary Party 
##                                                                                 7 
##                                                                         You Party 
##                                                                                 1 
##                                             Your Right To Democracy Party Limited 
##                                                                                 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">party<span class="fl">.10</span>.keep &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Conservative and Unionist Party&quot;</span>, <span class="st">&quot;Green Party&quot;</span>, <span class="st">&quot;Labour Party&quot;</span>, 
                  <span class="st">&quot;Labour Party/Co-operative Party&quot;</span>, <span class="st">&quot;Liberal Democrats&quot;</span>, <span class="st">&quot;Plaid Cymru - The Party of Wales&quot;</span>,
                   <span class="st">&quot;Scottish National Party (SNP)&quot;</span>, <span class="st">&quot;UK Independence Party (UK I P)&quot;</span>)

spend<span class="fl">.10</span>.sub &lt;-<span class="st"> </span><span class="kw">subset</span>(spend<span class="fl">.10</span>.sub, party %in%<span class="st"> </span>party<span class="fl">.10</span>.keep)

## Make party names consistent for merging
party<span class="fl">.15</span>.names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Conservative&quot;</span>, <span class="st">&quot;Green&quot;</span>, <span class="st">&quot;Labour&quot;</span>, <span class="st">&quot;Labour&quot;</span>, <span class="st">&quot;LibDem&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;SNP&quot;</span>, <span class="st">&quot;UKIP&quot;</span>)
party<span class="fl">.10</span>.names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Conservative&quot;</span>, <span class="st">&quot;Green&quot;</span>, <span class="st">&quot;Labour&quot;</span>, <span class="st">&quot;Labour&quot;</span>, <span class="st">&quot;LibDem&quot;</span>, <span class="st">&quot;PC&quot;</span>, <span class="st">&quot;SNP&quot;</span>, <span class="st">&quot;UKIP&quot;</span>)

spend<span class="fl">.15</span>.sub$party &lt;-<span class="st"> </span><span class="kw">mapvalues</span>(spend<span class="fl">.15</span>.sub$party, <span class="dt">from =</span> party<span class="fl">.15</span>.keep, <span class="dt">to =</span> party<span class="fl">.15</span>.names)
spend<span class="fl">.10</span>.sub$party &lt;-<span class="st"> </span><span class="kw">mapvalues</span>(spend<span class="fl">.10</span>.sub$party, <span class="dt">from =</span> party<span class="fl">.10</span>.keep, <span class="dt">to =</span> party<span class="fl">.10</span>.names)

## Merge 2015 and 2010 spending data
f &lt;-<span class="st"> </span><span class="kw">left_join</span>(spend<span class="fl">.15</span>.sub, spend<span class="fl">.10</span>.sub, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ons&quot;</span>, <span class="st">&quot;party&quot;</span>))

## Merge spending data with BES election results
ff &lt;-<span class="st"> </span><span class="kw">left_join</span>(bes.long, f, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ons&quot;</span>, <span class="st">&quot;party&quot;</span>))

## Merge spending and election results with vote intention data
fff &lt;-<span class="st"> </span><span class="kw">left_join</span>(ff, vote.intent, <span class="dt">by =</span> <span class="st">&quot;ons&quot;</span>)

## Merge spending, election, and vote intention data with Ashcroft results
df &lt;-<span class="st"> </span><span class="kw">left_join</span>(fff, polls.long, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;ons&quot;</span>, <span class="st">&quot;party&quot;</span>))</code></pre></div>
<pre><code>## Warning in left_join_impl(x, y, by$x, by$y, suffix$x, suffix$y): joining
## factor and character vector, coercing into character vector</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(df, <span class="st">&quot;Spending_Data_Merged_Final_May_2017.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)
     

############################################################################</code></pre></div>
<p>Clear the workspace and start anew</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Spending_Data_Merged_Final_May_2017.csv&quot;</span>)</code></pre></div>
<p>Generate 2010 marginality score</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Find the highest vote share in 2010
df &lt;-<span class="st"> </span><span class="kw">merge</span>(df, <span class="kw">aggregate</span>(v2010 ~<span class="st"> </span>ons, <span class="dt">data =</span> df, max),
                    <span class="dt">by =</span> <span class="st">&quot;ons&quot;</span>, <span class="dt">suffixes =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;.1st&quot;</span>))

## Second highest vote share in 2010
df &lt;-<span class="st"> </span><span class="kw">merge</span>(df, <span class="kw">aggregate</span>(v2010 ~<span class="st"> </span>ons, <span class="dt">data =</span> df, function(x){<span class="kw">sort</span>(<span class="kw">na.omit</span>(x), <span class="dt">decreasing=</span>T)[<span class="dv">2</span>]}),
            <span class="dt">by =</span> <span class="st">&quot;ons&quot;</span>, <span class="dt">suffixes =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;.2nd&quot;</span>))

## 2010 marginality scores (absolute value)
df$con.margin10 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df$party ==<span class="st"> &quot;Conservative&quot;</span>, 
                          <span class="kw">abs</span>(<span class="kw">ifelse</span>(df$winner10 ==<span class="st"> &quot;Conservative&quot;</span>, df$v2010 -<span class="st"> </span>df$v2010.2nd, df$v2010 -<span class="st"> </span>df$v2010.1st)),
                          <span class="ot">NA</span>)

df$lab.margin10 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df$party ==<span class="st"> &quot;Labour&quot;</span>, 
                          <span class="kw">abs</span>(<span class="kw">ifelse</span>(df$winner10 ==<span class="st"> &quot;Labour&quot;</span>, df$v2010 -<span class="st"> </span>df$v2010.2nd, df$v2010 -<span class="st"> </span>df$v2010.1st)),
                          <span class="ot">NA</span>)

df$ld.margin10 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df$party ==<span class="st"> &quot;LibDem&quot;</span>, 
                         <span class="kw">abs</span>(<span class="kw">ifelse</span>(df$winner10 ==<span class="st"> &quot;Liberal Democrat&quot;</span>, df$v2010 -<span class="st"> </span>df$v2010.2nd, df$v2010 -<span class="st"> </span>df$v2010.1st)),
                         <span class="ot">NA</span>)

<span class="kw">summary</span>(df$con.margin10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##       0      10      20      21      30      65    4424</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df$lab.margin10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##       0      10      24      24      36      58    4425</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df$ld.margin10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##       0      18      26      25      32      61    4425</code></pre>
<p>Generate 2015 constituency marginality measures based on Ashcroft polls</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Find the Ashcroft poll leader in 2015
df &lt;-<span class="st"> </span><span class="kw">merge</span>(df, <span class="kw">aggregate</span>(poll<span class="fl">.1</span> ~<span class="st"> </span>ons, <span class="dt">data =</span> df, max),
            <span class="dt">by =</span> <span class="st">&quot;ons&quot;</span>, <span class="dt">suffixes =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;.1st&quot;</span>), <span class="dt">all =</span> <span class="ot">TRUE</span>)

## Ashcroft poll runner-up in 2015
df &lt;-<span class="st"> </span><span class="kw">merge</span>(df, <span class="kw">aggregate</span>(poll<span class="fl">.1</span> ~<span class="st"> </span>ons, <span class="dt">data =</span> df, function(x){<span class="kw">sort</span>(<span class="kw">na.omit</span>(x), <span class="dt">decreasing=</span>T)[<span class="dv">2</span>]}),
            <span class="dt">by =</span> <span class="st">&quot;ons&quot;</span>, <span class="dt">suffixes =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;.2nd&quot;</span>), <span class="dt">all =</span> <span class="ot">TRUE</span>)

## Name the party leader in the most recent Ashcroft poll
poll.leader &lt;-<span class="st"> </span>df %&gt;%<span class="st"> </span><span class="kw">group_by</span>(ons) %&gt;%<span class="st"> </span><span class="kw">slice</span>(<span class="kw">which.max</span>(poll<span class="fl">.1</span>)) %&gt;%<span class="st"> </span><span class="kw">subset</span>(<span class="dt">select =</span> <span class="kw">c</span>(<span class="st">&quot;ons&quot;</span>, <span class="st">&quot;party&quot;</span>))
poll.leader$poll.leader &lt;-<span class="st"> </span>poll.leader$party
poll.leader$party &lt;-<span class="st"> </span><span class="ot">NULL</span>
df &lt;-<span class="st"> </span><span class="kw">left_join</span>(df, poll.leader, <span class="dt">by =</span> <span class="st">&quot;ons&quot;</span>)
<span class="kw">rm</span>(poll.leader)

## 2015 marginality scores (positive = leading in the latest poll)
df$con.margin15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df$party ==<span class="st"> &quot;Conservative&quot;</span>, 
                          <span class="kw">abs</span>(<span class="kw">ifelse</span>(df$poll.leader ==<span class="st"> &quot;Conservative&quot;</span>, df$poll<span class="fl">.1</span> -<span class="st"> </span>df$poll<span class="fl">.1</span>.2nd, df$poll<span class="fl">.1</span> -<span class="st"> </span>df$poll<span class="fl">.1</span>.1st)),
                          <span class="ot">NA</span>)

df$lab.margin15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df$party ==<span class="st"> &quot;Labour&quot;</span>, 
                          <span class="kw">abs</span>(<span class="kw">ifelse</span>(df$poll.leader ==<span class="st"> &quot;Labour&quot;</span>, df$poll<span class="fl">.1</span> -<span class="st"> </span>df$poll<span class="fl">.1</span>.2nd, df$poll<span class="fl">.1</span> -<span class="st"> </span>df$poll<span class="fl">.1</span>.1st)),
                          <span class="ot">NA</span>)

df$ld.margin15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df$party ==<span class="st"> &quot;LibDem&quot;</span>, 
                         <span class="kw">abs</span>(<span class="kw">ifelse</span>(df$poll.leader ==<span class="st"> &quot;LibDem&quot;</span>, df$poll<span class="fl">.1</span> -<span class="st"> </span>df$poll<span class="fl">.1</span>.2nd, df$poll<span class="fl">.1</span> -<span class="st"> </span>df$poll<span class="fl">.1</span>.1st)),
                         <span class="ot">NA</span>)

<span class="kw">summary</span>(df$con.margin15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##       0       5      10      14      20      53    4889</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df$lab.margin15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##       0       6      11      13      20      42    4889</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(df$ld.margin15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##       1      20      33      29      37      56    4889</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Ashcroft poll conducted?
df$ashcroft &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df$poll<span class="fl">.1</span>.1st &gt;<span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)
df$ashcroft[<span class="kw">is.na</span>(df$ashcroft)] &lt;-<span class="st"> </span><span class="dv">0</span></code></pre></div>
<p>Subset the merged data by party</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">con &lt;-<span class="st"> </span><span class="kw">subset</span>(df, party ==<span class="st"> &quot;Conservative&quot;</span>)
lab &lt;-<span class="st"> </span><span class="kw">subset</span>(df, party ==<span class="st"> &quot;Labour&quot;</span>)
ld &lt;-<span class="st"> </span><span class="kw">subset</span>(df, party ==<span class="st"> &quot;LibDem&quot;</span>)</code></pre></div>
<p>Descriptive statistics for campaign spending</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Percent of 2015 short campaign constituency spending
<span class="kw">summary</span>(con$shortpct15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0    24.0    56.8    53.6    83.2    98.9       1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab$shortpct15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0    16.1    47.4    47.3    77.0   145.0       1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld$shortpct15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.00    3.77    8.38   20.80   22.90  107.00       1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Potential 2015 missing data
<span class="kw">length</span>(con$shortpct15[con$shortpct15 ==<span class="st"> &quot;0&quot;</span>]) </code></pre></div>
<pre><code>## [1] 36</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(lab$shortpct15[lab$shortpct15 ==<span class="st"> &quot;0&quot;</span>]) </code></pre></div>
<pre><code>## [1] 39</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(ld$shortpct15[ld$shortpct15 ==<span class="st"> &quot;0&quot;</span>])</code></pre></div>
<pre><code>## [1] 106</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 2015 Spending data, removing 0s (which may be missing or true 0; cannot tell)
con$short15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(con$shortpct15 &gt;<span class="st"> </span><span class="dv">0</span>, con$shortpct15, <span class="ot">NA</span>)
lab$short15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(lab$shortpct15 &gt;<span class="st"> </span><span class="dv">0</span>, lab$shortpct15, <span class="ot">NA</span>)
ld$short15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ld$shortpct15 &gt;<span class="st"> </span><span class="dv">0</span>, ld$shortpct15, <span class="ot">NA</span>)

<span class="kw">summary</span>(con$short15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.23   29.50   61.60   56.70   84.20   98.90      36</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab$short15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.24   19.10   49.70   50.30   78.90  145.00      39</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld$short15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.07    6.42   10.70   25.00   28.80  107.00     106</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Percent of 2010 short campaign constituency spending
<span class="kw">summary</span>(con$shortpct10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0    45.1    76.9    65.8    90.5   105.0       2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab$shortpct10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0    18.8    54.2    50.4    78.7   109.0       2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld$shortpct10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.00    8.89   22.90   37.00   66.80  101.00       2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 2010 Spending data 
con$short10 &lt;-<span class="st"> </span>con$shortpct10
lab$short10 &lt;-<span class="st"> </span>lab$shortpct10
ld$short10 &lt;-<span class="st"> </span>ld$shortpct10 

<span class="kw">summary</span>(con$short10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0    45.1    76.9    65.8    90.5   105.0       2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab$short10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0    18.8    54.2    50.4    78.7   109.0       2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld$short10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##    0.00    8.89   22.90   37.00   66.80  101.00       2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 2010 election winner (dummy)
con$win10 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(con$winner10 ==<span class="st"> &quot;Conservative&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) 
lab$win10 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(lab$winner10 ==<span class="st"> &quot;Labour&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) 
ld$win10 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ld$winner10 ==<span class="st"> &quot;Liberal Democrat&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) 

<span class="kw">summary</span>(con$win10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   0.000   0.000   0.484   1.000   1.000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab$win10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   0.000   0.000   0.408   1.000   1.000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld$win10)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.0000  0.0902  0.0000  1.0000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 2015 poll leader (dummy)
con$lead15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(con$poll.leader ==<span class="st"> &quot;Conservative&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) 
lab$lead15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(lab$poll.leader ==<span class="st"> &quot;Labour&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) 
ld$lead15 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(ld$poll.leader ==<span class="st"> &quot;LibDem&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>) 

<span class="kw">summary</span>(con$lead15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0     0.0     0.0     0.3     1.0     1.0     465</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab$lead15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0     0.0     0.0     0.4     1.0     1.0     465</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld$lead15)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##     0.0     0.0     0.0     0.1     0.0     1.0     465</code></pre>
<p>Results</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Conservative spending models
con.m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*con.margin10, <span class="dt">data =</span> con)                                       <span class="co"># Prior information only</span>
con.m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*con.margin10 +<span class="st"> </span>con.intent +<span class="st"> </span>ashcroft, <span class="dt">data =</span> con)               <span class="co"># Plus Ashcroft poll</span>
con.m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*con.margin10 +<span class="st"> </span>con.intent +<span class="st"> </span>con.margin15, <span class="dt">data =</span> con)           <span class="co"># Plus Ashcroft marginals</span>

<span class="kw">summary</span>(con.m1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * con.margin10, data = con)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -59.47 -14.25  -0.32  12.68  63.83 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         35.2812     4.0200    8.78 &lt; 0.0000000000000002 ***
## short10              0.3927     0.0391   10.05 &lt; 0.0000000000000002 ***
## win10               13.8428     3.1072    4.46       0.000010037134 ***
## con.margin10        -0.6952     0.1012   -6.87       0.000000000017 ***
## win10:con.margin10   0.2530     0.1369    1.85                0.065 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 20.2 on 590 degrees of freedom
##   (37 observations deleted due to missingness)
## Multiple R-squared:  0.557,  Adjusted R-squared:  0.554 
## F-statistic:  186 on 4 and 590 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(con.m2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * con.margin10 + con.intent + 
##     ashcroft, data = con)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -52.60 -11.58   0.53   9.86  60.16 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         27.6912     4.1427    6.68       0.000000000054 ***
## short10              0.3520     0.0361    9.74 &lt; 0.0000000000000002 ***
## win10                4.6494     2.9798    1.56                0.119    
## con.margin10        -0.6329     0.0954   -6.63       0.000000000074 ***
## con.intent           0.1593     0.0820    1.94                0.053 .  
## ashcroft            20.4759     1.9551   10.47 &lt; 0.0000000000000002 ***
## win10:con.margin10   0.6805     0.1409    4.83       0.000001749049 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 18.5 on 588 degrees of freedom
##   (37 observations deleted due to missingness)
## Multiple R-squared:  0.628,  Adjusted R-squared:  0.625 
## F-statistic:  166 on 6 and 588 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(con.m3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * con.margin10 + con.intent + 
##     con.margin15, data = con)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -45.86  -4.78   2.50   6.41  51.41 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         70.4539     7.4288    9.48 &lt; 0.0000000000000002 ***
## short10              0.2275     0.0603    3.77              0.00023 ***
## win10               -6.3618     3.0986   -2.05              0.04173 *  
## con.margin10        -0.8773     0.1550   -5.66          0.000000071 ***
## con.intent           0.2497     0.1184    2.11              0.03651 *  
## con.margin15        -0.5476     0.1767   -3.10              0.00230 ** 
## win10:con.margin10   1.0740     0.2840    3.78              0.00022 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 13.3 on 156 degrees of freedom
##   (469 observations deleted due to missingness)
## Multiple R-squared:  0.792,  Adjusted R-squared:  0.784 
## F-statistic: 99.2 on 6 and 156 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Labour spending models
lab.m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*lab.margin10, <span class="dt">data =</span> lab)                                       <span class="co"># Prior information only</span>
lab.m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*lab.margin10 +<span class="st"> </span>lab.intent +<span class="st"> </span>ashcroft, <span class="dt">data =</span> lab)               <span class="co"># Plus Ashcroft poll</span>
lab.m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*lab.margin10 +<span class="st"> </span>lab.intent +<span class="st"> </span>lab.margin15, <span class="dt">data =</span> lab)           <span class="co"># Plus Ashcroft marginals</span>

<span class="kw">summary</span>(lab.m1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * lab.margin10, data = lab)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -59.27 -10.89  -0.81  10.92  87.99 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         59.7005     3.7673   15.85 &lt; 0.0000000000000002 ***
## short10              0.3643     0.0392    9.30 &lt; 0.0000000000000002 ***
## win10              -18.2272     2.9965   -6.08  0.00000000212834975 ***
## lab.margin10        -1.2023     0.0910  -13.21 &lt; 0.0000000000000002 ***
## win10:lab.margin10   1.0179     0.1232    8.26  0.00000000000000097 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 19.1 on 588 degrees of freedom
##   (39 observations deleted due to missingness)
## Multiple R-squared:  0.632,  Adjusted R-squared:  0.63 
## F-statistic:  253 on 4 and 588 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab.m2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * lab.margin10 + lab.intent + 
##     ashcroft, data = lab)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -63.98 -11.73  -0.84  10.66  87.34 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         58.0589     4.7726   12.16 &lt; 0.0000000000000002 ***
## short10              0.3644     0.0380    9.58 &lt; 0.0000000000000002 ***
## win10              -10.8121     3.2493   -3.33              0.00093 ***
## lab.margin10        -1.0910     0.0988  -11.05 &lt; 0.0000000000000002 ***
## lab.intent          -0.2189     0.0767   -2.85              0.00446 ** 
## ashcroft            11.0017     2.0315    5.42      0.0000000892283 ***
## win10:lab.margin10   0.9756     0.1364    7.15      0.0000000000025 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 18.5 on 586 degrees of freedom
##   (39 observations deleted due to missingness)
## Multiple R-squared:  0.656,  Adjusted R-squared:  0.653 
## F-statistic:  186 on 6 and 586 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab.m3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * lab.margin10 + lab.intent + 
##     lab.margin15, data = lab)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -69.27 -11.09   0.63  10.36  73.50 
## 
## Coefficients:
##                    Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)         82.6534     8.9992    9.18 0.00000000000000028 ***
## short10              0.1669     0.0764    2.18              0.0306 *  
## win10               -6.1240     5.7599   -1.06              0.2894    
## lab.margin10        -1.2530     0.2053   -6.10 0.00000000815731028 ***
## lab.intent           0.0622     0.1619    0.38              0.7012    
## lab.margin15        -0.6718     0.2036   -3.30              0.0012 ** 
## win10:lab.margin10   1.0724     0.2818    3.81              0.0002 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 19.2 on 153 degrees of freedom
##   (472 observations deleted due to missingness)
## Multiple R-squared:  0.66,   Adjusted R-squared:  0.647 
## F-statistic: 49.5 on 6 and 153 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Liberal Democratic spending models
ld.m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*ld.margin10, <span class="dt">data =</span> ld)                                          <span class="co"># Prior information only</span>
ld.m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*ld.margin10 +<span class="st"> </span>ld.intent +<span class="st"> </span>ashcroft, <span class="dt">data =</span> ld)                   <span class="co"># Plus Ashcroft poll</span>
ld.m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(short15 ~<span class="st"> </span>short10 +<span class="st"> </span>win10*ld.margin10 +<span class="st"> </span>ld.intent +<span class="st"> </span>ld.margin15, <span class="dt">data =</span> ld)                <span class="co"># Plus Ashcroft marginals</span>

<span class="kw">summary</span>(ld.m1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * ld.margin10, data = ld)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -62.39  -7.83  -1.91   4.56  76.02 
## 
## Coefficients:
##                   Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)        24.1359     3.2831    7.35     0.00000000000077 ***
## short10             0.2121     0.0314    6.76     0.00000000003637 ***
## win10              50.0863     4.1522   12.06 &lt; 0.0000000000000002 ***
## ld.margin10        -0.5671     0.0949   -5.98     0.00000000419696 ***
## win10:ld.margin10   0.4998     0.2455    2.04                0.042 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 16.4 on 520 degrees of freedom
##   (107 observations deleted due to missingness)
## Multiple R-squared:  0.704,  Adjusted R-squared:  0.701 
## F-statistic:  309 on 4 and 520 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld.m2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * ld.margin10 + ld.intent + 
##     ashcroft, data = ld)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -62.98  -7.71  -1.93   4.57  75.48 
## 
## Coefficients:
##                   Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)        22.3470     3.5207    6.35        0.00000000048 ***
## short10             0.2074     0.0315    6.58        0.00000000012 ***
## win10              49.1805     4.4237   11.12 &lt; 0.0000000000000002 ***
## ld.margin10        -0.5531     0.0960   -5.76        0.00000001454 ***
## ld.intent           0.2970     0.1205    2.46                0.014 *  
## ashcroft           -0.8958     1.7804   -0.50                0.615    
## win10:ld.margin10   0.4516     0.2461    1.83                0.067 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 16.4 on 518 degrees of freedom
##   (107 observations deleted due to missingness)
## Multiple R-squared:  0.707,  Adjusted R-squared:  0.704 
## F-statistic:  209 on 6 and 518 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld.m3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * ld.margin10 + ld.intent + 
##     ld.margin15, data = ld)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -42.64  -8.76  -1.43   6.88  50.19 
## 
## Coefficients:
##                   Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept)         48.984      7.348    6.67 0.00000000055 ***
## short10              0.110      0.062    1.77         0.079 .  
## win10               38.751      5.740    6.75 0.00000000035 ***
## ld.margin10         -0.443      0.195   -2.27         0.025 *  
## ld.intent            0.188      0.196    0.96         0.340    
## ld.margin15         -0.769      0.191   -4.03 0.00008976071 ***
## win10:ld.margin10    0.656      0.357    1.84         0.068 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 15.4 on 141 degrees of freedom
##   (484 observations deleted due to missingness)
## Multiple R-squared:  0.856,  Adjusted R-squared:  0.85 
## F-statistic:  140 on 6 and 141 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Table 1 - Prior information only
<span class="kw">summary</span>(con.m1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * con.margin10, data = con)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -59.47 -14.25  -0.32  12.68  63.83 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         35.2812     4.0200    8.78 &lt; 0.0000000000000002 ***
## short10              0.3927     0.0391   10.05 &lt; 0.0000000000000002 ***
## win10               13.8428     3.1072    4.46       0.000010037134 ***
## con.margin10        -0.6952     0.1012   -6.87       0.000000000017 ***
## win10:con.margin10   0.2530     0.1369    1.85                0.065 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 20.2 on 590 degrees of freedom
##   (37 observations deleted due to missingness)
## Multiple R-squared:  0.557,  Adjusted R-squared:  0.554 
## F-statistic:  186 on 4 and 590 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab.m1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * lab.margin10, data = lab)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -59.27 -10.89  -0.81  10.92  87.99 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         59.7005     3.7673   15.85 &lt; 0.0000000000000002 ***
## short10              0.3643     0.0392    9.30 &lt; 0.0000000000000002 ***
## win10              -18.2272     2.9965   -6.08  0.00000000212834975 ***
## lab.margin10        -1.2023     0.0910  -13.21 &lt; 0.0000000000000002 ***
## win10:lab.margin10   1.0179     0.1232    8.26  0.00000000000000097 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 19.1 on 588 degrees of freedom
##   (39 observations deleted due to missingness)
## Multiple R-squared:  0.632,  Adjusted R-squared:  0.63 
## F-statistic:  253 on 4 and 588 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld.m1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * ld.margin10, data = ld)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -62.39  -7.83  -1.91   4.56  76.02 
## 
## Coefficients:
##                   Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)        24.1359     3.2831    7.35     0.00000000000077 ***
## short10             0.2121     0.0314    6.76     0.00000000003637 ***
## win10              50.0863     4.1522   12.06 &lt; 0.0000000000000002 ***
## ld.margin10        -0.5671     0.0949   -5.98     0.00000000419696 ***
## win10:ld.margin10   0.4998     0.2455    2.04                0.042 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 16.4 on 520 degrees of freedom
##   (107 observations deleted due to missingness)
## Multiple R-squared:  0.704,  Adjusted R-squared:  0.701 
## F-statistic:  309 on 4 and 520 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Table 2 - Prior information plus presence of Ashcroft poll and BES vote intention
<span class="kw">summary</span>(con.m2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * con.margin10 + con.intent + 
##     ashcroft, data = con)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -52.60 -11.58   0.53   9.86  60.16 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         27.6912     4.1427    6.68       0.000000000054 ***
## short10              0.3520     0.0361    9.74 &lt; 0.0000000000000002 ***
## win10                4.6494     2.9798    1.56                0.119    
## con.margin10        -0.6329     0.0954   -6.63       0.000000000074 ***
## con.intent           0.1593     0.0820    1.94                0.053 .  
## ashcroft            20.4759     1.9551   10.47 &lt; 0.0000000000000002 ***
## win10:con.margin10   0.6805     0.1409    4.83       0.000001749049 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 18.5 on 588 degrees of freedom
##   (37 observations deleted due to missingness)
## Multiple R-squared:  0.628,  Adjusted R-squared:  0.625 
## F-statistic:  166 on 6 and 588 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab.m2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * lab.margin10 + lab.intent + 
##     ashcroft, data = lab)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -63.98 -11.73  -0.84  10.66  87.34 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         58.0589     4.7726   12.16 &lt; 0.0000000000000002 ***
## short10              0.3644     0.0380    9.58 &lt; 0.0000000000000002 ***
## win10              -10.8121     3.2493   -3.33              0.00093 ***
## lab.margin10        -1.0910     0.0988  -11.05 &lt; 0.0000000000000002 ***
## lab.intent          -0.2189     0.0767   -2.85              0.00446 ** 
## ashcroft            11.0017     2.0315    5.42      0.0000000892283 ***
## win10:lab.margin10   0.9756     0.1364    7.15      0.0000000000025 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 18.5 on 586 degrees of freedom
##   (39 observations deleted due to missingness)
## Multiple R-squared:  0.656,  Adjusted R-squared:  0.653 
## F-statistic:  186 on 6 and 586 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld.m2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * ld.margin10 + ld.intent + 
##     ashcroft, data = ld)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -62.98  -7.71  -1.93   4.57  75.48 
## 
## Coefficients:
##                   Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)        22.3470     3.5207    6.35        0.00000000048 ***
## short10             0.2074     0.0315    6.58        0.00000000012 ***
## win10              49.1805     4.4237   11.12 &lt; 0.0000000000000002 ***
## ld.margin10        -0.5531     0.0960   -5.76        0.00000001454 ***
## ld.intent           0.2970     0.1205    2.46                0.014 *  
## ashcroft           -0.8958     1.7804   -0.50                0.615    
## win10:ld.margin10   0.4516     0.2461    1.83                0.067 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 16.4 on 518 degrees of freedom
##   (107 observations deleted due to missingness)
## Multiple R-squared:  0.707,  Adjusted R-squared:  0.704 
## F-statistic:  209 on 6 and 518 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Table 3 - Prior information plus Ashcroft poll marginals and BES vote intention
<span class="kw">summary</span>(con.m3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * con.margin10 + con.intent + 
##     con.margin15, data = con)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -45.86  -4.78   2.50   6.41  51.41 
## 
## Coefficients:
##                    Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)         70.4539     7.4288    9.48 &lt; 0.0000000000000002 ***
## short10              0.2275     0.0603    3.77              0.00023 ***
## win10               -6.3618     3.0986   -2.05              0.04173 *  
## con.margin10        -0.8773     0.1550   -5.66          0.000000071 ***
## con.intent           0.2497     0.1184    2.11              0.03651 *  
## con.margin15        -0.5476     0.1767   -3.10              0.00230 ** 
## win10:con.margin10   1.0740     0.2840    3.78              0.00022 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 13.3 on 156 degrees of freedom
##   (469 observations deleted due to missingness)
## Multiple R-squared:  0.792,  Adjusted R-squared:  0.784 
## F-statistic: 99.2 on 6 and 156 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lab.m3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * lab.margin10 + lab.intent + 
##     lab.margin15, data = lab)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -69.27 -11.09   0.63  10.36  73.50 
## 
## Coefficients:
##                    Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)         82.6534     8.9992    9.18 0.00000000000000028 ***
## short10              0.1669     0.0764    2.18              0.0306 *  
## win10               -6.1240     5.7599   -1.06              0.2894    
## lab.margin10        -1.2530     0.2053   -6.10 0.00000000815731028 ***
## lab.intent           0.0622     0.1619    0.38              0.7012    
## lab.margin15        -0.6718     0.2036   -3.30              0.0012 ** 
## win10:lab.margin10   1.0724     0.2818    3.81              0.0002 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 19.2 on 153 degrees of freedom
##   (472 observations deleted due to missingness)
## Multiple R-squared:  0.66,   Adjusted R-squared:  0.647 
## F-statistic: 49.5 on 6 and 153 DF,  p-value: &lt;0.0000000000000002</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ld.m3)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = short15 ~ short10 + win10 * ld.margin10 + ld.intent + 
##     ld.margin15, data = ld)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -42.64  -8.76  -1.43   6.88  50.19 
## 
## Coefficients:
##                   Estimate Std. Error t value      Pr(&gt;|t|)    
## (Intercept)         48.984      7.348    6.67 0.00000000055 ***
## short10              0.110      0.062    1.77         0.079 .  
## win10               38.751      5.740    6.75 0.00000000035 ***
## ld.margin10         -0.443      0.195   -2.27         0.025 *  
## ld.intent            0.188      0.196    0.96         0.340    
## ld.margin15         -0.769      0.191   -4.03 0.00008976071 ***
## win10:ld.margin10    0.656      0.357    1.84         0.068 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 15.4 on 141 degrees of freedom
##   (484 observations deleted due to missingness)
## Multiple R-squared:  0.856,  Adjusted R-squared:  0.85 
## F-statistic:  140 on 6 and 141 DF,  p-value: &lt;0.0000000000000002</code></pre>

</body>
</html>
